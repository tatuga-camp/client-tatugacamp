!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.ModelManager");let r=e=>t=>(e=>{var t,r;let o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&((t=String).prototype.isPrototypeOf(e)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name)?"string":o})(t)===e,o=e=>t=>typeof t===e,l=e=>t=>e===t,n=r("string"),s=r("object"),a=r("array"),i=l(null),m=o("boolean"),d=l(void 0),c=e=>null!=e,u=o("function"),f=o("number"),g=()=>{},h=e=>()=>e,p=e=>e,b=(e,t)=>e===t;function w(e,...t){return(...r)=>{let o=t.concat(r);return e.apply(null,o)}}let v=e=>t=>!e(t),y=e=>e(),x=h(!1),C=h(!0);class S{constructor(e,t){this.tag=e,this.value=t}static some(e){return new S(!0,e)}static none(){return S.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?S.some(e(this.value)):S.none()}bind(e){return this.tag?e(this.value):S.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:S.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return c(e)?S.some(e):S.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}S.singletonNone=new S(!1);let T=Array.prototype.slice,R=Array.prototype.indexOf,D=Array.prototype.push,O=(e,t)=>R.call(e,t)>-1,k=(e,t)=>{for(let r=0,o=e.length;r<o;r++)if(t(e[r],r))return!0;return!1},E=(e,t)=>{let r=[];for(let o=0;o<e;o++)r.push(t(o));return r},N=(e,t)=>{let r=e.length,o=Array(r);for(let l=0;l<r;l++){let r=e[l];o[l]=t(r,l)}return o},B=(e,t)=>{for(let r=0,o=e.length;r<o;r++)t(e[r],r)},_=(e,t)=>{let r=[],o=[];for(let l=0,n=e.length;l<n;l++){let n=e[l];(t(n,l)?r:o).push(n)}return{pass:r,fail:o}},z=(e,t)=>{let r=[];for(let o=0,l=e.length;o<l;o++){let l=e[o];t(l,o)&&r.push(l)}return r},A=(e,t,r)=>(((e,t)=>{for(let r=e.length-1;r>=0;r--)t(e[r],r)})(e,(e,o)=>{r=t(r,e,o)}),r),L=(e,t,r)=>(B(e,(e,o)=>{r=t(r,e,o)}),r),W=(e,t)=>((e,t,r)=>{for(let o=0,l=e.length;o<l;o++){let l=e[o];if(t(l,o))return S.some(l);if(r(l,o))break}return S.none()})(e,t,x),M=(e,t)=>{for(let r=0,o=e.length;r<o;r++)if(t(e[r],r))return S.some(r);return S.none()},j=e=>{let t=[];for(let r=0,o=e.length;r<o;++r){if(!a(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);D.apply(t,e[r])}return t},P=(e,t)=>j(N(e,t)),I=(e,t)=>{for(let r=0,o=e.length;r<o;++r)if(!0!==t(e[r],r))return!1;return!0},F=(e,t)=>{let r={};for(let o=0,l=e.length;o<l;o++){let l=e[o];r[String(l)]=t(l,o)}return r},H=(e,t)=>t>=0&&t<e.length?S.some(e[t]):S.none(),$=e=>H(e,0),V=e=>H(e,e.length-1),q=(e,t)=>{for(let r=0;r<e.length;r++){let o=t(e[r],r);if(o.isSome())return o}return S.none()},U=Object.keys,G=Object.hasOwnProperty,K=(e,t)=>{let r=U(e);for(let o=0,l=r.length;o<l;o++){let l=r[o];t(e[l],l)}},Y=(e,t)=>J(e,(e,r)=>({k:r,v:t(e,r)})),J=(e,t)=>{let r={};return K(e,(e,o)=>{let l=t(e,o);r[l.k]=l.v}),r},Q=(e,t)=>{let r=[];return K(e,(e,o)=>{r.push(t(e,o))}),r},X=e=>Q(e,p),Z=(e,t)=>G.call(e,t),ee="undefined"!=typeof window?window:Function("return this;")(),et=(e,t)=>((e,t)=>{let r=null!=t?t:ee;for(let t=0;t<e.length&&null!=r;++t)r=r[e[t]];return r})(e.split("."),t),er=Object.getPrototypeOf,eo=e=>{let t=et("ownerDocument.defaultView",e);return s(e)&&(((e,t)=>{let r=et(e,t);if(null==r)throw Error(e+" not available on this browser");return r})("HTMLElement",t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(er(e).constructor.name))},el=e=>e.dom.nodeName.toLowerCase(),en=e=>e.dom.nodeType,es=e=>t=>en(t)===e,ea=e=>8===en(e)||"#comment"===el(e),ei=e=>em(e)&&eo(e.dom),em=es(1),ed=es(3),ec=es(9),eu=es(11),ef=e=>t=>em(t)&&el(t)===e,eg=(e,t,r)=>{if(!(n(r)||m(r)||f(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(t,r+"")},eh=(e,t,r)=>{eg(e.dom,t,r)},ep=(e,t)=>{let r=e.dom;K(t,(e,t)=>{eg(r,t,e)})},eb=(e,t)=>{let r=e.dom.getAttribute(t);return null===r?void 0:r},ew=(e,t)=>S.from(eb(e,t)),ev=(e,t)=>{e.dom.removeAttribute(t)},ey=e=>L(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),ex=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},eC={fromHtml:(e,t)=>{let r=(t||document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return ex(r.childNodes[0])},fromTag:(e,t)=>ex((t||document).createElement(e)),fromText:(e,t)=>ex((t||document).createTextNode(e)),fromDom:ex,fromPoint:(e,t,r)=>S.from(e.dom.elementFromPoint(t,r)).map(ex)},eS=(e,t)=>{let r=e.dom;if(1!==r.nodeType)return!1;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},eT=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,eR=(e,t)=>{let r=void 0===t?document:t.dom;return eT(r)?S.none():S.from(r.querySelector(e)).map(eC.fromDom)},eD=(e,t)=>e.dom===t.dom,eO=(e,t)=>{let r=e.dom,o=t.dom;return r!==o&&r.contains(o)},ek=e=>eC.fromDom(e.dom.ownerDocument),eE=e=>ec(e)?e:ek(e),eN=e=>S.from(e.dom.parentNode).map(eC.fromDom),eB=e=>S.from(e.dom.parentElement).map(eC.fromDom),e_=(e,t)=>{let r=u(t)?t:x,o=e.dom,l=[];for(;null!==o.parentNode&&void 0!==o.parentNode;){let e=o.parentNode,t=eC.fromDom(e);if(l.push(t),!0===r(t))break;o=e}return l},ez=e=>S.from(e.dom.previousSibling).map(eC.fromDom),eA=e=>S.from(e.dom.nextSibling).map(eC.fromDom),eL=e=>N(e.dom.childNodes,eC.fromDom),eW=(e,t)=>{let r=e.dom.childNodes;return S.from(r[t]).map(eC.fromDom)},eM=(e,t)=>{eN(e).each(r=>{r.dom.insertBefore(t.dom,e.dom)})},ej=(e,t)=>{eA(e).fold(()=>{eN(e).each(e=>{eI(e,t)})},e=>{eM(e,t)})},eP=(e,t)=>{eW(e,0).fold(()=>{eI(e,t)},r=>{e.dom.insertBefore(t.dom,r.dom)})},eI=(e,t)=>{e.dom.appendChild(t.dom)},eF=(e,t)=>{eM(e,t),eI(t,e)},eH=(e,t)=>{B(t,(r,o)=>{ej(0===o?e:t[o-1],r)})},e$=(e,t)=>{B(t,t=>{eI(e,t)})},eV=e=>{e.dom.textContent="",B(eL(e),e=>{eq(e)})},eq=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},eU=e=>{let t=eL(e);t.length>0&&eH(e,t),eq(e)},eG=(e,t)=>eC.fromDom(e.dom.cloneNode(t)),eK=e=>eG(e,!1),eY=e=>eG(e,!0),eJ=(e,t)=>{let r=eC.fromTag(t);return ep(r,ey(e)),r},eQ=["tfoot","thead","tbody","colgroup"],eX=(e,t,r)=>({element:e,rowspan:t,colspan:r}),eZ=(e,t,r)=>({element:e,cells:t,section:r}),e0=(e,t,r)=>({element:e,isNew:t,isLocked:r}),e1=(e,t,r,o)=>({element:e,cells:t,section:r,isNew:o}),e9=u(Element.prototype.attachShadow)&&u(Node.prototype.getRootNode),e3=h(e9),e5=e9?e=>eC.fromDom(e.dom.getRootNode()):eE,e2=e=>eC.fromDom(e.dom.host),e7=e=>{let t=ed(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let r=t.ownerDocument;return(e=>{let t=e5(e);return eu(t)&&c(t.dom.host)?S.some(t):S.none()})(eC.fromDom(t)).fold(()=>r.body.contains(t),e=>e7(e2(e)))},e4=e=>{let t=e.dom.body;if(null==t)throw Error("Body is not available yet");return eC.fromDom(t)},e6=(e,t)=>{let r=[];return B(eL(e),e=>{t(e)&&(r=r.concat([e])),r=r.concat(e6(e,t))}),r},e8=(e,t,r)=>z(e_(e,r),e=>eS(e,t)),te=(e,t)=>z(eL(e),e=>eS(e,t)),tt=(e,t)=>((e,t)=>{let r=void 0===t?document:t.dom;return eT(r)?[]:N(r.querySelectorAll(e),eC.fromDom)})(t,e);var tr=(e,t,r,o,l)=>e(r,o)?S.some(r):u(l)&&l(r)?S.none():t(r,o,l);let to=(e,t,r)=>{let o=e.dom,l=u(r)?r:x;for(;o.parentNode;){o=o.parentNode;let e=eC.fromDom(o);if(t(e))return S.some(e);if(l(e))break}return S.none()},tl=(e,t,r)=>tr((e,t)=>t(e),to,e,t,r),tn=(e,t,r)=>to(e,e=>eS(e,t),r),ts=(e,t)=>W(e.dom.childNodes,e=>eS(eC.fromDom(e),t)).map(eC.fromDom),ta=(e,t)=>eR(t,e),ti=(e,t,r)=>tr((e,t)=>eS(e,t),tn,e,t,r),tm=(e,t,r=b)=>e.exists(e=>r(e,t)),td=e=>{let t=[],r=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(r);return t},tc=(e,t)=>e?S.some(t):S.none(),tu=(e,t,r)=>""===t||e.length>=t.length&&e.substr(r,r+t.length)===t,tf=(e,t,r=0,o)=>{let l=e.indexOf(t,r);return -1!==l&&(!!d(o)||l+t.length<=o)},tg=(e,t)=>tu(e,t,0),th=(e,t)=>tu(e,t,e.length-t.length),tp=(e=/^\s+|\s+$/g,t=>t.replace(e,"")),tb=e=>e.length>0,tw=e=>void 0!==e.style&&u(e.style.getPropertyValue),tv=(e,t,r)=>{if(!n(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),Error("CSS value must be a string: "+r);tw(e)&&e.style.setProperty(t,r)},ty=(e,t,r)=>{tv(e.dom,t,r)},tx=(e,t)=>{let r=e.dom;K(t,(e,t)=>{tv(r,t,e)})},tC=(e,t)=>{let r=e.dom,o=window.getComputedStyle(r).getPropertyValue(t);return""!==o||e7(e)?o:tS(r,t)},tS=(e,t)=>tw(e)?e.style.getPropertyValue(t):"",tT=(e,t)=>{let r=tS(e.dom,t);return S.from(r).filter(e=>e.length>0)},tR=(e,t)=>{var r;tw(r=e.dom)&&r.style.removeProperty(t),tm(ew(e,"style").map(tp),"")&&ev(e,"style")},tD=(e,t,r=0)=>ew(e,t).map(e=>parseInt(e,10)).getOr(r),tO=(e,t)=>tD(e,t,1),tk=e=>ef("col")(e)?tD(e,"span",1)>1:tO(e,"colspan")>1,tE=(e,t)=>parseInt(tC(e,t),10),tN=h(10),tB=h(10),t_=(e,t)=>tz(e,t,C),tz=(e,t,r)=>P(eL(e),e=>eS(e,t)?r(e)?[e]:[]:tz(e,t,r)),tA=(e,t)=>((e,t,r=x)=>r(t)?S.none():O(e,el(t))?S.some(t):tn(t,e.join(","),e=>eS(e,"table")||r(e)))(["td","th"],e,t),tL=e=>t_(e,"th,td"),tW=e=>eS(e,"colgroup")?te(e,"col"):P(tP(e),e=>te(e,"col")),tM=(e,t)=>ti(e,"table",t),tj=e=>t_(e,"tr"),tP=e=>tM(e).fold(h([]),e=>te(e,"colgroup")),tI=(e,t)=>N(e,e=>{if("colgroup"===el(e)){let t=N(tW(e),e=>{let t=tD(e,"span",1);return eX(e,1,t)});return eZ(e,t,"colgroup")}{let r=N(tL(e),e=>{let t=tD(e,"rowspan",1),r=tD(e,"colspan",1);return eX(e,t,r)});return eZ(e,r,t(e))}}),tF=e=>eN(e).map(e=>{let t=el(e);return O(eQ,t)?t:"tbody"}).getOr("tbody"),tH=e=>{let t=tj(e);return tI([...tP(e),...t],tF)},t$=e=>{let t,r=!1;return(...o)=>(r||(r=!0,t=e.apply(null,o)),t)},tV=()=>tq(0,0),tq=(e,t)=>({major:e,minor:t}),tU={nu:tq,detect:(e,t)=>{let r=String(t).toLowerCase();return 0===e.length?tV():((e,t)=>{let r=((e,t)=>{for(let r=0;r<e.length;r++){let o=e[r];if(o.test(t))return o}})(e,t);if(!r)return{major:0,minor:0};let o=e=>Number(t.replace(r,"$"+e));return tq(o(1),o(2))})(e,r)},unknown:tV},tG=(e,t)=>{let r=String(t).toLowerCase();return W(e,e=>e.search(r))},tK=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tY=e=>t=>tf(t,e),tJ=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>tf(e,"edge/")&&tf(e,"chrome")&&tf(e,"safari")&&tf(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,tK],search:e=>tf(e,"chrome")&&!tf(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>tf(e,"msie")||tf(e,"trident")},{name:"Opera",versionRegexes:[tK,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tY("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tY("firefox")},{name:"Safari",versionRegexes:[tK,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(tf(e,"safari")||tf(e,"mobile/"))&&tf(e,"applewebkit")}],tQ=[{name:"Windows",search:tY("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>tf(e,"iphone")||tf(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tY("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tY("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tY("linux"),versionRegexes:[]},{name:"Solaris",search:tY("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tY("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tY("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tX={browsers:h(tJ),oses:h(tQ)},tZ="Edge",t0="Chromium",t1="Opera",t9="Firefox",t3="Safari",t5=e=>{let t=e.current,r=e.version,o=e=>()=>t===e;return{current:t,version:r,isEdge:o(tZ),isChromium:o(t0),isIE:o("IE"),isOpera:o(t1),isFirefox:o(t9),isSafari:o(t3)}},t2=()=>t5({current:void 0,version:tU.unknown()}),t7=(h(tZ),h(t0),h("IE"),h(t1),h(t9),h(t3),"Windows"),t4="Android",t6="Linux",t8="macOS",re="Solaris",rt="FreeBSD",rr="ChromeOS",ro=e=>{let t=e.current,r=e.version,o=e=>()=>t===e;return{current:t,version:r,isWindows:o(t7),isiOS:o("iOS"),isAndroid:o(t4),isMacOS:o(t8),isLinux:o(t6),isSolaris:o(re),isFreeBSD:o(rt),isChromeOS:o(rr)}},rl=()=>ro({current:void 0,version:tU.unknown()}),rn=(h(t7),h("iOS"),h(t4),h(t6),h(t8),h(re),h(rt),h(rr),e=>window.matchMedia(e).matches),rs=t$(()=>((e,t,r)=>{let o=tX.browsers(),l=tX.oses(),n=t.bind(e=>q(e.brands,e=>{let t=e.brand.toLowerCase();return W(o,e=>{var r;return t===(null===(r=e.brand)||void 0===r?void 0:r.toLowerCase())}).map(t=>({current:t.name,version:tU.nu(parseInt(e.version,10),0)}))})).orThunk(()=>tG(o,e).map(t=>{let r=tU.detect(t.versionRegexes,e);return{current:t.name,version:r}})).fold(t2,t5),s=tG(l,e).map(t=>{let r=tU.detect(t.versionRegexes,e);return{current:t.name,version:r}}).fold(rl,ro),a=((e,t,r,o)=>{let l=e.isiOS()&&!0===/ipad/i.test(r),n=e.isiOS()&&!l,s=e.isiOS()||e.isAndroid(),a=s||o("(pointer:coarse)"),i=l||!n&&s&&o("(min-device-width:768px)"),m=n||s&&!i,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(r);return{isiPad:h(l),isiPhone:h(n),isTablet:h(i),isPhone:h(m),isTouch:h(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:h(d),isDesktop:h(!m&&!i&&!d)}})(s,n,e,r);return{browser:n,os:s,deviceType:a}})(navigator.userAgent,S.from(navigator.userAgentData),rn)),ra=()=>rs(),ri=(e,t)=>{let r=r=>{let o=t(r);return o<=0||null===o?parseFloat(tC(r,e))||0:o},o=(e,t)=>L(t,(t,r)=>{let o=tC(e,r),l=void 0===o?0:parseInt(o,10);return isNaN(l)?t:t+l},0);return{set:(t,r)=>{if(!f(r)&&!r.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+r);let o=t.dom;tw(o)&&(o.style[e]=r+"px")},get:r,getOuter:r,aggregate:o,max:(e,t,r)=>{let l=o(e,r);return t>l?t-l:0}}},rm=(e,t,r)=>(e=>{let t=parseFloat(e);return isNaN(t)?S.none():S.some(t)})(tC(e,t)).getOr(r),rd=ri("width",e=>e.dom.offsetWidth),rc=e=>rd.get(e),ru=e=>rd.getOuter(e),rf=e=>((e,t)=>{var r,o;let l=e.dom,n=l.getBoundingClientRect().width||l.offsetWidth;return"border-box"===t?n:(r="left",o="right",n-rm(e,`padding-${r}`,0)-rm(e,`padding-${o}`,0)-rm(e,`border-${r}-width`,0)-rm(e,`border-${o}-width`,0))})(e,"content-box"),rg=(e,t,r)=>{let o=e.cells,l=o.slice(0,t),n=o.slice(t);return rb(e,l.concat(r).concat(n))},rh=(e,t,r)=>rg(e,t,[r]),rp=(e,t,r)=>{e.cells[t]=r},rb=(e,t)=>e1(e.element,t,e.section,e.isNew),rw=(e,t)=>e.cells[t],rv=(e,t)=>rw(e,t).element,ry=e=>e.cells.length,rx=e=>{let t=_(e,e=>"colgroup"===e.section);return{rows:t.fail,cols:t.pass}},rC=(e,t,r)=>{let o=N(e.cells,r);return e1(t(e.element),o,e.section,!0)},rS="data-snooker-locked-cols",rT=e=>ew(e,rS).bind(e=>S.from(e.match(/\d+/g))).map(e=>F(e,C)),rR=e=>((e,t)=>{let r=T.call(e,0);return r.sort(void 0),r})(Q(L(rx(e).rows,(e,t)=>(B(t.cells,(t,r)=>{t.isLocked&&(e[r]=!0)}),e),{}),(e,t)=>parseInt(t,10))),rD=(e,t)=>e+","+t,rO=(e,t)=>z(P(e.all,e=>e.cells),t),rk=e=>{let t={},r=[],o=$(e).map(e=>e.element).bind(tM).bind(rT).getOr({}),l=0,n=0,s=0,{pass:a,fail:i}=_(e,e=>"colgroup"===e.section);B(i,e=>{let a=[];B(e.cells,e=>{var r,l;let i=0;for(;void 0!==t[rD(s,i)];)i++;let m=Z(o,r=i.toString())&&void 0!==o[r]&&null!==o[r],d=(l=e.element,{element:l,rowspan:e.rowspan,colspan:e.colspan,row:s,column:i,isLocked:m});for(let r=0;r<e.colspan;r++)for(let o=0;o<e.rowspan;o++){let e=i+r;t[rD(s+o,e)]=d,n=Math.max(n,e+1)}a.push(d)}),l++,r.push(eZ(e.element,a,e.section)),s++});let{columns:m,colgroups:d}=V(a).map(e=>{let t=(e=>{let t={},r=0;return B(e.cells,e=>{let o=e.colspan;E(o,l=>{let n=r+l;t[n]={element:e.element,colspan:o,column:n}}),r+=o}),t})(e);return{colgroups:[{element:e.element,columns:X(t)}],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}}));return{grid:{rows:l,columns:n},access:t,all:r,columns:m,colgroups:d}},rE=e=>rk(tH(e)),rN=(e,t,r)=>S.from(e.access[rD(t,r)]),rB=(e,t,r)=>{let o=rO(e,e=>r(t,e.element));return o.length>0?S.some(o[0]):S.none()},r_=e=>P(e.all,e=>e.cells),rz=e=>X(e.columns),rA=e=>U(e.columns).length>0,rL=(e,t)=>S.from(e.columns[t]),rW=(e,t=C)=>{let r=e.grid,o=E(r.columns,p),l=E(r.rows,p);return N(o,r=>rM(()=>P(l,t=>rN(e,t,r).filter(e=>e.column===r).toArray()),e=>1===e.colspan&&t(e.element),()=>rN(e,0,r)))},rM=(e,t,r)=>{let o=e();return W(o,t).orThunk(()=>S.from(o[0]).orThunk(r)).map(e=>e.element)},rj=e=>{let t=e.grid,r=E(t.rows,p),o=E(t.columns,p);return N(r,t=>rM(()=>P(o,r=>rN(e,t,r).filter(e=>e.row===t).fold(h([]),e=>[e])),e=>1===e.rowspan,()=>rN(e,t,0)))},rP=(e,t)=>r=>"rtl"===rI(r)?t:e,rI=e=>"rtl"===tC(e,"direction")?"rtl":"ltr",rF=ri("height",e=>{let t=e.dom;return e7(e)?t.getBoundingClientRect().height:t.offsetHeight}),rH=e=>rF.get(e),r$=e=>rF.getOuter(e),rV=(e,t)=>({left:e,top:t,translate:(r,o)=>rV(e+r,t+o)}),rq=(e,t)=>void 0!==e?e:void 0!==t?t:0,rU=e=>{let t=e.dom.ownerDocument,r=t.body,o=t.defaultView,l=t.documentElement;if(r===e.dom)return rV(r.offsetLeft,r.offsetTop);let n=rq(null==o?void 0:o.pageYOffset,l.scrollTop),s=rq(null==o?void 0:o.pageXOffset,l.scrollLeft),a=rq(l.clientTop,r.clientTop),i=rq(l.clientLeft,r.clientLeft);return rG(e).translate(s-i,n-a)},rG=e=>{let t=e.dom,r=t.ownerDocument.body;return r===t?rV(r.offsetLeft,r.offsetTop):e7(e)?(e=>{let t=e.getBoundingClientRect();return rV(t.left,t.top)})(t):rV(0,0)},rK=(e,t)=>({row:e,y:t}),rY=(e,t)=>({col:e,x:t}),rJ=e=>rU(e).left+ru(e),rQ=e=>rU(e).left,rX=(e,t)=>rY(e,rQ(t)),rZ=(e,t)=>rY(e,rJ(t)),r0=e=>rU(e).top,r1=(e,t)=>rK(e,r0(t)),r9=(e,t)=>rK(e,r0(t)+r$(t)),r3=(e,t,r)=>{if(0===r.length)return[];let o=N(r.slice(1),(t,r)=>t.map(t=>e(r,t))),l=r[r.length-1].map(e=>t(r.length-1,e));return o.concat([l])},r5={delta:p,positions:e=>r3(r1,r9,e),edge:r0},r2=rP({delta:p,edge:rQ,positions:e=>r3(rX,rZ,e)},{delta:e=>-e,edge:rJ,positions:e=>r3(rZ,rX,e)}),r7={delta:(e,t)=>r2(t).delta(e,t),positions:(e,t)=>r2(t).positions(e,t),edge:e=>r2(e).edge(e)},r4={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},r6=(()=>{let e="[0-9]+",t="[eE][+-]?"+e,r=e=>`(?:${e})?`,o=["Infinity",e+"\\."+r(e)+r(t),"\\."+e+r(t),e+r(t)].join("|");return RegExp(`^([+-]?(?:${o}))(.*)$`)})(),r8=/(\d+(\.\d+)?)%/,oe=/(\d+(\.\d+)?)px|em/,ot=ef("col"),or=ef("tr"),oo=(e,t,r)=>{let o=eB(e).getOrThunk(()=>e4(ek(e)));return t(e)/r(o)*100},ol=(e,t)=>{ty(e,"width",t+"px")},on=(e,t)=>{ty(e,"width",t+"%")},os=(e,t)=>{ty(e,"height",t+"px")},oa=e=>{let t=rm(e,"height",e.dom.offsetHeight)+"px";return t?((e,t,r,o)=>{let l=parseFloat(e);return th(e,"%")&&"table"!==el(t)?((e,t,r,o)=>{let l=tM(e).map(e=>Math.floor(t/100*r(e))).getOr(t);return o(e,l),l})(t,l,r,o):l})(t,e,rH,os):rH(e)},oi=(e,t)=>tT(e,t).orThunk(()=>ew(e,t).map(e=>e+"px")),om=e=>oi(e,"width"),od=e=>oo(e,rc,rf),oc=e=>ot(e)?rc(e):rm(e,"width",e.dom.offsetWidth),ou=e=>or(e)?rH(e):oa(e)/tO(e,"rowspan"),of=(e,t,r)=>{ty(e,"width",t+r)},og=e=>oo(e,rc,rf)+"%",oh=h(r8),op=ef("col"),ob=e=>om(e).getOrThunk(()=>oc(e)+"px"),ow=e=>oi(e,"height").getOrThunk(()=>ou(e)+"px"),ov=(e,t,r,o,l,n)=>e.filter(o).fold(()=>n(((e,t)=>{if(t<0||t>=e.length-1)return S.none();let r=e[t].fold(()=>q((e=>{let t=T.call(e,0);return t.reverse(),t})(e.slice(0,t)),(e,t)=>e.map(e=>({value:e,delta:t+1}))),e=>S.some({value:e,delta:0})),o=e[t+1].fold(()=>q(e.slice(t+1),(e,t)=>e.map(e=>({value:e,delta:t+1}))),e=>S.some({value:e,delta:1}));return r.bind(e=>o.map(t=>{let r=t.delta+e.delta;return Math.abs(t.value-e.value)/r}))})(r,t)),e=>l(e)),oy=(e,t,r,o)=>{let l=rW(e),n=rA(e)?N(rz(e),e=>S.from(e.element)):l,s=[S.some(r7.edge(t))].concat(N(r7.positions(l,t),e=>e.map(e=>e.x))),a=v(tk);return N(n,(e,t)=>ov(e,t,s,a,e=>{var n;return(e=>{let t=ra().browser,r=t.isChromium()||t.isFirefox();return!op(e)||r})(e)?r(e):ov(null!=(n=l[t])?p(n):S.none(),t,s,a,e=>o(S.some(rc(e))),o)},o))},ox=e=>e.map(e=>e+"px").getOr(""),oC=(e,t,r)=>oy(e,t,oc,e=>e.getOrThunk(r.minCellWidth)),oS=(e,t,r,o)=>{let l=rj(e),n=N(e.all,e=>S.some(e.element)),s=[S.some(r5.edge(t))].concat(N(r5.positions(l,t),e=>e.map(e=>e.y)));return N(n,(e,t)=>ov(e,t,s,C,r,o))},oT=(e,t)=>()=>e7(e)?t(e):parseFloat(tT(e,"width").getOr("0")),oR=e=>{let t=oT(e,e=>parseFloat(og(e))),r=oT(e,rc);return{width:t,pixelWidth:r,getWidths:(t,r)=>oy(t,e,od,e=>e.fold(()=>r.minCellWidth(),e=>e/r.pixelWidth()*100)),getCellDelta:e=>e/r()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>tN()/r()*100,setElementWidth:on,adjustTableWidth:r=>{let o=t();on(e,o+r/100*o)},isRelative:!0,label:"percent"}},oD=e=>{let t=oT(e,rc);return{width:t,pixelWidth:t,getWidths:(t,r)=>oC(t,e,r),getCellDelta:p,singleColumnWidth:(e,t)=>[Math.max(tN(),e+t)-e],minCellWidth:tN,setElementWidth:ol,adjustTableWidth:r=>{ol(e,t()+r)},isRelative:!1,label:"pixel"}},oO=e=>om(e).fold(()=>(e=>{let t=oT(e,rc),r=h(0);return{width:t,pixelWidth:t,getWidths:(t,r)=>oC(t,e,r),getCellDelta:r,singleColumnWidth:h([0]),minCellWidth:r,setElementWidth:g,adjustTableWidth:g,isRelative:!0,label:"none"}})(e),t=>null!==oh().exec(t)?oR(e):oD(e)),ok=(e,t,r)=>{let o=e[r].element,l=eC.fromTag("td");eI(l,eC.fromTag("br")),(t?eI:eP)(o,l)},oE=((e,t)=>{let r=t=>e(t)?S.from(t.dom.nodeValue):S.none();return{get:t=>{if(!e(t))throw Error("Can only get text value of a text node");return r(t).getOr("")},getOption:r,set:(t,r)=>{if(!e(t))throw Error("Can only set raw text value of a text node");t.dom.nodeValue=r}}})(ed),oN=e=>oE.get(e),oB=e=>oE.getOption(e),o_=(e,t)=>oE.set(e,t),oz=e=>"img"===el(e)?1:oB(e).fold(()=>eL(e).length,e=>e.length),oA=["img","br"],oL=e=>oB(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome()||O(oA,el(e))||ei(e)&&"false"===eb(e,"contenteditable"),oW=e=>((e,t)=>{let r=e=>{for(let o=0;o<e.childNodes.length;o++){let l=eC.fromDom(e.childNodes[o]);if(t(l))return S.some(l);let n=r(e.childNodes[o]);if(n.isSome())return n}return S.none()};return r(e.dom)})(e,oL),oM=e=>oj(e,oL),oj=(e,t)=>{let r=e=>{let o=eL(e);for(let e=o.length-1;e>=0;e--){let l=o[e];if(t(l))return S.some(l);let n=r(l);if(n.isSome())return n}return S.none()};return r(e)},oP={scope:["row","col"]},oI=e=>()=>{let t=eC.fromTag("td",e.dom);return eI(t,eC.fromTag("br",e.dom)),t},oF=e=>()=>eC.fromTag("col",e.dom),oH=e=>()=>eC.fromTag("colgroup",e.dom),o$=e=>()=>eC.fromTag("tr",e.dom),oV=(e,t,r)=>{let o=((e,t)=>{let r=eJ(e,t);return e$(r,eL(eY(e))),r})(e,t);return K(r,(e,t)=>{null===e?ev(o,t):eh(o,t,e)}),o},oq=e=>e,oU=(e,t,r)=>{let o=(e,t)=>{((e,t)=>{let r=e.dom,o=t.dom;tw(r)&&tw(o)&&(o.style.cssText=r.style.cssText)})(e.element,t),tR(t,"height"),1!==e.colspan&&tR(t,"width")};return{col:r=>{let l=eC.fromTag(el(r.element),t.dom);return o(r,l),e(r.element,l),l},colgroup:oH(t),row:o$(t),cell:l=>{var n,s;let a=eC.fromTag(el(l.element),t.dom),i=r.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=i.length>0?oW(n=l.element).map(e=>A(e8(e,i.join(","),e=>eD(e,n)),(e,t)=>{let r=eK(t);return eI(e,r),r},a)).getOr(a):a;return eI(m,eC.fromTag("br")),o(l,a),s=l.element,K(oP,(e,t)=>ew(s,t).filter(t=>O(e,t)).each(e=>eh(a,t,e))),e(l.element,a),a},replace:oV,colGap:oF(t),gap:oI(t)}},oG=e=>({col:oF(e),colgroup:oH(e),row:o$(e),cell:oI(e),replace:oq,colGap:oF(e),gap:oI(e)}),oK=e=>t=>t.options.get(e),oY="100%",oJ=e=>{var t;let r=e.dom,o=null!==(t=r.getParent(e.selection.getStart(),r.isBlock))&&void 0!==t?t:e.getBody();return rf(eC.fromDom(o))+"px"},oQ=e=>S.from(e.options.get("table_clone_elements")),oX=oK("table_header_type"),oZ=oK("table_column_resizing"),o0=e=>"preservetable"===oZ(e),o1=e=>"resizetable"===oZ(e),o9=oK("table_sizing_mode"),o3=e=>"relative"===o9(e),o5=e=>"fixed"===o9(e),o2=e=>"responsive"===o9(e),o7=oK("table_resize_bars"),o4=oK("table_style_by_css"),o6=oK("table_merge_content_on_paste"),o8=e=>{let t=e.options,r=t.get("table_default_attributes");return t.isSet("table_default_attributes")?r:o2(e)||o4(e)?r:o5(e)?{...r,width:oJ(e)}:{...r,width:oY}},le=oK("table_use_colgroups"),lt=e=>ti(e,"[contenteditable]"),lr=(e,t=!1)=>e7(e)?e.dom.isContentEditable:lt(e).fold(h(t),e=>"true"===lo(e)),lo=e=>e.dom.contentEditable,ll=e=>eC.fromDom(e.getBody()),ln=e=>t=>eD(t,ll(e)),ls=e=>{ev(e,"data-mce-style");let t=e=>ev(e,"data-mce-style");B(tL(e),t),B(tW(e),t),B(tj(e),t)},la=e=>eC.fromDom(e.selection.getStart()),li=e=>e.getBoundingClientRect().width,lm=e=>e.getBoundingClientRect().height,ld=e=>(t,r)=>{let o=t.dom.getStyle(r,e)||t.dom.getAttrib(r,e);return S.from(o).filter(tb)},lc=ld("width"),lu=ld("height"),lf=e=>tl(e,ef("table")).exists(lr),lg=(e,t)=>{let r=t.column,o=t.column+t.colspan-1,l=t.row,n=t.row+t.rowspan-1;return r<=e.finishCol&&o>=e.startCol&&l<=e.finishRow&&n>=e.startRow},lh=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,lp=(e,t,r)=>{let o=rB(e,t,eD),l=rB(e,r,eD);return o.bind(e=>l.map(t=>({startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)})))},lb=(e,t,r)=>lp(e,t,r).map(t=>N(rO(e,w(lg,t)),e=>e.element)),lw=(e,t)=>rB(e,t,(e,t)=>eO(t,e)).map(e=>e.element),lv=(e,t,r)=>lb(lx(e),t,r),ly=(e,t,r,o,l)=>{let n=lx(e),s=eD(e,r)?S.some(t):lw(n,t),a=eD(e,l)?S.some(o):lw(n,o);return s.bind(e=>a.bind(t=>lb(n,e,t)))},lx=rE;var lC=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],lS=()=>({up:h({selector:tn,closest:ti,predicate:to,all:e_}),down:h({selector:tt,predicate:e6}),styles:h({get:tC,getRaw:tT,set:ty,remove:tR}),attrs:h({get:eb,set:eh,remove:ev,copyTo:(e,t)=>{ep(t,ey(e))}}),insert:h({before:eM,after:ej,afterAll:eH,append:eI,appendAll:e$,prepend:eP,wrap:eF}),remove:h({unwrap:eU,remove:eq}),create:h({nu:eC.fromTag,clone:e=>eC.fromDom(e.dom.cloneNode(!1)),text:eC.fromText}),query:h({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:ez,nextSibling:eA}),property:h({children:eL,name:el,parent:eN,document:e=>eE(e).dom,isText:ed,isComment:ea,isElement:em,isSpecial:e=>O(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],el(e)),getLanguage:e=>em(e)?ew(e,"lang"):S.none(),getText:oN,setText:o_,isBoundary:e=>!!em(e)&&("body"===el(e)||O(lC,el(e))),isEmptyTag:e=>!!em(e)&&O(["br","img","hr","input"],el(e)),isNonEditable:e=>em(e)&&"false"===eb(e,"contenteditable")}),eq:eD,is:eS});let lT=(e,t,r,o)=>A(o,(r,o)=>{let l=t(e,o);return lR(e,r,l)},t(e,r)),lR=(e,t,r)=>t.bind(t=>r.filter(w(e.eq,t))),lD=lS(),lO=(e,t)=>t.length>0?lT(lD,(t,r)=>e(r),t[0],t.slice(1)):S.none(),lk=e=>tn(e,"table"),lE=(e,t,r)=>{let o=e=>t=>void 0!==r&&r(t)||eD(t,e);return eD(e,t)?S.some({boxes:S.some([e]),start:e,finish:t}):lk(e).bind(l=>lk(t).bind(n=>{if(eD(l,n))return S.some({boxes:lv(l,e,t),start:e,finish:t});if(eO(l,n)){let r=e8(t,"td,th",o(l)),s=r.length>0?r[r.length-1]:t;return S.some({boxes:ly(l,e,l,t,n),start:e,finish:s})}if(eO(n,l)){let r=e8(e,"td,th",o(n)),s=r.length>0?r[r.length-1]:e;return S.some({boxes:ly(n,e,l,t,n),start:e,finish:s})}return((e,t,r,o=x)=>{let l=[t].concat(e.up().all(t)),n=[r].concat(e.up().all(r)),s=e=>M(e,o).fold(()=>e,t=>e.slice(0,t+1)),a=s(l),i=s(n),m=W(a,t=>k(i,w(e.eq,t)));return{firstpath:a,secondpath:i,shared:m}})(lD,e,t,void 0).shared.bind(s=>ti(s,"table",r).bind(r=>{let s=e8(t,"td,th",o(r)),a=s.length>0?s[s.length-1]:t,i=e8(e,"td,th",o(r)),m=i.length>0?i[i.length-1]:e;return S.some({boxes:ly(r,e,l,t,n),start:m,finish:a})}))}))},lN=(e,t)=>{let r=tt(e,t);return r.length>0?S.some(r):S.none()},lB=(e,t,r)=>ta(e,t).bind(t=>ta(e,r).bind(e=>lO(lk,[t,e]).map(r=>({first:t,last:e,table:r})))),l_=(e,t,r,o,l)=>W(e,e=>eS(e,l)).bind(e=>tM(e).bind(o=>{var l;return rB(l=lx(o),e,eD).bind(e=>rN(l,(t>0?e.row+e.rowspan-1:e.row)+t,(r>0?e.column+e.colspan-1:e.column)+r).map(e=>e.element))}).bind(e=>tn(e,"table").bind(t=>ta(t,o).bind(t=>lE(t,e).bind(e=>e.boxes.map(t=>({boxes:t,start:e.start,finish:e.finish}))))))),lz=(e,t)=>lN(e,t),lA=(e,t,r)=>lB(e,t,r).bind(t=>{let r=t=>eD(e,t),o="thead,tfoot,tbody,table",l=tn(t.first,o,r),n=tn(t.last,o,r);return l.bind(e=>n.bind(r=>{var o,l,n,s;return eD(e,r)?(o=t.table,l=t.first,n=t.last,lp(s=lx(o),l,n).bind(e=>((e,t)=>{let r=!0,o=w(lh,t);for(let l=t.startRow;l<=t.finishRow;l++)for(let n=t.startCol;n<=t.finishCol;n++)r=r&&rN(e,l,n).exists(o);return r?S.some(t):S.none()})(s,e))):S.none()}))}),lL=e=>{let t=(e,t)=>ew(e,t).exists(e=>parseInt(e,10)>1);return e.length>0&&I(e,e=>t(e,"rowspan")||t(e,"colspan"))?S.some(e):S.none()},lW=(e,t,r)=>t.length<=1?S.none():lA(e,r.firstSelectedSelector,r.lastSelectedSelector).map(e=>({bounds:e,cells:t})),lM="data-mce-selected",lj="data-mce-first-selected",lP="data-mce-last-selected",lI="["+lM+"]",lF={selected:lM,selectedSelector:"td["+lM+"],th["+lM+"]",firstSelected:lj,firstSelectedSelector:"td["+lj+"],th["+lj+"]",lastSelected:lP,lastSelectedSelector:"td["+lP+"],th["+lP+"]"},lH=(e,t,r)=>({element:r,mergable:lW(t,e,lF),unmergable:lL(e),selection:p(e)}),l$=e=>(t,r)=>{let o=el(t);return ti("col"===o||"colgroup"===o?tM(t).bind(e=>lz(e,lF.firstSelectedSelector)).fold(h(t),e=>e[0]):t,e,r)},lV=l$("th,td,caption"),lq=l$("th,td"),lU=e=>N(e.model.table.getSelectedCells(),eC.fromDom),lG=(e,t)=>{e.on("BeforeGetContent",t=>{if(!0===t.selection){let r=z(lU(e),e=>eS(e,lF.selectedSelector));r.length>=1&&(t.preventDefault(),tM(r[0]).map(e=>{let t=((e,t)=>{let r=e=>eS(e.element,t),o=eY(e),l=tH(o),n=oO(e),s=rk(l),a=((e,t)=>{let r=e.grid.columns,o=e.grid.rows,l=r,n=0,s=0,a=[],i=[];return K(e.access,e=>{if(a.push(e),t(e)){i.push(e);let t=e.row,r=t+e.rowspan-1,a=e.column,m=a+e.colspan-1;t<o?o=t:r>n&&(n=r),a<l?l=a:m>s&&(s=m)}}),{minRow:o,minCol:l,maxRow:n,maxCol:s,allCells:a,selectedCells:i}})(s,r),i="th:not("+t+"),td:not("+t+")";B(tz(o,"th,td",e=>eS(e,i)),eq),((e,t,r,o)=>{let l=z(e,e=>"colgroup"!==e.section),n=t.grid.columns,s=t.grid.rows;for(let e=0;e<s;e++){let s=!1;for(let a=0;a<n;a++)e<r.minRow||e>r.maxRow||a<r.minCol||a>r.maxCol||(rN(t,e,a).filter(o).isNone()?ok(l,s,e):s=!0)}})(l,s,a,r);let m=((e,t,r,o)=>{if(0===o.minCol&&t.grid.columns===o.maxCol+1)return 0;let l=oC(t,e,r),n=L(l,(e,t)=>e+t,0),s=L(l.slice(o.minCol,o.maxCol+1),(e,t)=>e+t,0)/n*r.pixelWidth()-r.pixelWidth();return r.getCellDelta(s)})(e,rE(e),n,a);return K(s.columns,e=>{(e.column<a.minCol||e.column>a.maxCol)&&eq(e.element)}),B(z(t_(o,"tr"),e=>0===e.dom.childElementCount),eq),a.minCol!==a.maxCol&&a.minRow!==a.maxRow||B(t_(o,"th,td"),e=>{ev(e,"rowspan"),ev(e,"colspan")}),ev(o,rS),ev(o,"data-snooker-col-series"),oO(o).adjustTableWidth(m),o})(e,lI);return ls(t),[t]}).each(r=>{t.content="text"===t.format?N(r,e=>e.dom.innerText).join(""):N(r,t=>e.selection.serializer.serialize(t.dom,{})).join("")}))}}),e.on("BeforeSetContent",r=>{!0===r.selection&&!0===r.paste&&$(lU(e)).each(o=>{tM(o).each(l=>{let n=z(((e,t)=>{let r=document.createElement("div");return r.innerHTML=e,eL(eC.fromDom(r))})(r.content),e=>"meta"!==el(e)),s=ef("table");if(o6(e)&&1===n.length&&s(n[0])){r.preventDefault();let s=oG(eC.fromDom(e.getDoc())),a={element:o,clipboard:n[0],generators:s};t.pasteCells(l,a).each(()=>{e.focus()})}})})})},lK=(e,t)=>({element:e,offset:t}),lY=(e,t,r)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?r(t).bind(t=>lY(e,t,r).orThunk(()=>S.some(t))):S.none(),lJ=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,lQ=(e,t)=>{let r=lY(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(r))return lK(r,lJ(e,r));let o=e.property().children(r);return o.length>0?lQ(e,o[o.length-1]):lK(r,lJ(e,r))},lX=lS(),lZ=(e,t)=>{tk(e)||om(e).bind(e=>{var t;return t=["fixed","relative","empty"],S.from(r6.exec(e)).bind(e=>{let r=Number(e[1]),o=e[2];return k(t,e=>k(r4[e],e=>o===e))?S.some({value:r,unit:o}):S.none()})}).each(r=>{let o=r.value/2;of(e,o,r.unit),of(t,o,r.unit)})},l0=e=>N(e,h(0)),l1=(e,t,r,o,l)=>l(e.slice(0,t)).concat(o).concat(l(e.slice(r))),l9=e=>(t,r,o,l)=>{if(e(o)){let e=Math.abs(Math.max(l,t[r]-Math.abs(o))-t[r]);return o>=0?e:-e}return o},l3=l9(e=>e<0),l5=l9(C),l2=()=>{let e=(e,t,r,o)=>{let l=(100+r)/100,n=Math.max(o,(e[t]+r)/l);return N(e,(e,r)=>(r===t?n:e/l)-e)},t=(t,r,o,l,n,s)=>s?e(t,r,l,n):((e,t,r,o,l)=>{let n=l3(e,t,o,l);return l1(e,t,r+1,[n,0],l0)})(t,r,o,l,n);return{resizeTable:(e,t)=>e(t),clampTableDelta:l3,calcLeftEdgeDeltas:t,calcMiddleDeltas:(e,r,o,l,n,s,a)=>t(e,o,l,n,s,a),calcRightEdgeDeltas:(t,r,o,l,n,s)=>{if(s)return e(t,o,l,n);{let e=l3(t,o,l,n);return l0(t.slice(0,o)).concat([e])}},calcRedestributedWidths:(e,t,r,o)=>{if(o){let o=(t+r)/t,l=N(e,e=>e/o);return{delta:100*o-100,newSizes:l}}return{delta:r,newSizes:e}}}},l7=()=>{let e=(e,t,r,o,l)=>{let n=l5(e,o>=0?r:t,o,l);return l1(e,t,r+1,[n,-n],l0)};return{resizeTable:(e,t,r)=>{r&&e(t)},clampTableDelta:(e,t,r,o,l)=>l?r>=0?r:Math.max(-L(e,(e,t)=>e+t-o,0),r):l3(e,t,r,o),calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,r,o,l,n,s)=>e(t,o,l,n,s),calcRightEdgeDeltas:(e,t,r,o,l,n)=>{if(n)return l0(e);{let t=o/e.length;return N(e,h(t))}},calcRedestributedWidths:(e,t,r,o)=>({delta:0,newSizes:e})}},l4=e=>rE(e).grid,l6=ef("th"),l8=e=>I(e,e=>l6(e.element)),ne=(e,t)=>e&&t?"sectionCells":e?"section":"cells",nt=e=>{let t="thead"===e.section,r=tm(nr(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||r?{type:"header",subType:ne(t,r)}:{type:"body"}},nr=e=>{let t=z(e,e=>l6(e.element));return 0===t.length?S.some("td"):t.length===e.length?S.some("th"):S.none()},no=(e,t,r)=>e0(r(e.element,t),!0,e.isLocked),nl=(e,t)=>e.section!==t?e1(e.element,e.cells,t,e.isNew):e,nn=()=>({transformRow:nl,transformCell:(e,t,r)=>{let o=r(e.element,t);return e0("td"!==el(o)?((e,t)=>{let r=eJ(e,"td");return ej(e,r),e$(r,eL(e)),eq(e),r})(o):o,e.isNew,e.isLocked)}}),ns=()=>({transformRow:nl,transformCell:no}),na=()=>({transformRow:(e,t)=>nl(e,"thead"===t?"tbody":t),transformCell:no}),ni=()=>({transformRow:p,transformCell:no}),nm=(e,t,r,o)=>{r===o?ev(e,t):eh(e,t,r)},nd=(e,t,r)=>{V(te(e,t)).fold(()=>eP(e,r),e=>ej(e,r))},nc=(e,t)=>{let r=[],o=[],l=e=>N(e,e=>{e.isNew&&r.push(e.element);let t=e.element;return eV(t),B(e.cells,e=>{e.isNew&&o.push(e.element),nm(e.element,"colspan",e.colspan,1),nm(e.element,"rowspan",e.rowspan,1),eI(t,e.element)}),t}),n=e=>P(e,e=>N(e.cells,e=>(nm(e.element,"span",e.colspan,1),e.element))),s=(t,r)=>{e$(((e,t)=>{let r=ts(e,t).getOrThunk(()=>{let r=eC.fromTag(t,ek(e).dom);return"thead"===t?nd(e,"caption,colgroup",r):"colgroup"===t?nd(e,"caption",r):eI(e,r),r});return eV(r),r})(e,r),("colgroup"===r?n:l)(t))},a=(t,r)=>{t.length>0?s(t,r):(t=>{ts(e,t).each(eq)})(r)},i=[],m=[],d=[],c=[];return B(t,e=>{switch(e.section){case"thead":i.push(e);break;case"tbody":m.push(e);break;case"tfoot":d.push(e);break;case"colgroup":c.push(e)}}),a(c,"colgroup"),a(i,"thead"),a(m,"tbody"),a(d,"tfoot"),{newRows:r,newCells:o}},nu=(e,t)=>{if(0===e.length)return 0;let r=e[0];return M(e,e=>!t(r.element,e.element)).getOr(e.length)},nf=(e,t)=>{let r=N(e,e=>N(e.cells,x));return N(e,(o,l)=>{let n=P(o.cells,(o,n)=>{var s;if(!1===r[l][n]){let a=((e,t,r,o)=>{let l=e[t],n="colgroup"===l.section;return{colspan:nu(l.cells.slice(r),o),rowspan:n?1:nu(N(e.slice(t),e=>rw(e,r)),o)}})(e,l,n,t);return((e,t,o,l)=>{for(let n=e;n<e+o;n++)for(let e=t;e<t+l;e++)r[n][e]=!0})(l,n,a.rowspan,a.colspan),[(s=o.element,{element:s,rowspan:a.rowspan,colspan:a.colspan,isNew:o.isNew})]}return[]});return{element:o.element,cells:n,section:o.section,isNew:o.isNew}})},ng=(e,t,r)=>{let o=[];B(e.colgroups,l=>{let n=[];for(let o=0;o<e.grid.columns;o++){let l=rL(e,o).map(e=>e0(e.element,r,!1)).getOrThunk(()=>e0(t.colGap(),!0,!1));n.push(l)}o.push(e1(l.element,n,"colgroup",r))});for(let l=0;l<e.grid.rows;l++){let n=[];for(let o=0;o<e.grid.columns;o++){let s=rN(e,l,o).map(e=>e0(e.element,r,e.isLocked)).getOrThunk(()=>e0(t.gap(),!0,!1));n.push(s)}let s=e.all[l],a=e1(s.element,n,s.section,r);o.push(a)}return o},nh=e=>nf(e,eD),np=(e,t)=>q(e.all,e=>W(e.cells,e=>eD(t,e.element))),nb=(e,t,r)=>{let o=td(N(t.selection,t=>tA(t).bind(t=>np(e,t)).filter(r)));return tc(o.length>0,o)},nw=(e,t,r,o,l)=>(n,s,a,i)=>{let m=rE(n),d=S.from(null==i?void 0:i.section).getOrThunk(ni);return t(m,s).map(t=>{let r=e(ng(m,a,!1),t,eD,l(a),d),o=rR(r.grid);return{info:t,grid:nh(r.grid),cursor:r.cursor,lockedColumns:o}}).bind(e=>{let t=nc(n,e.grid),l=S.from(null==i?void 0:i.sizing).getOrThunk(()=>oO(n)),s=S.from(null==i?void 0:i.resize).getOrThunk(l7);return r(n,e.grid,e.info,{sizing:l,resize:s,section:d}),o(n),ev(n,rS),e.lockedColumns.length>0&&eh(n,rS,e.lockedColumns.join(",")),S.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})},nv=(e,t)=>nb(e,t,C).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),ny=(e,t)=>nb(e,t,C),nx=(e,t)=>nb(e,t,e=>!e.isLocked),nC=(e,t)=>I(t,t=>np(e,t).exists(e=>!e.isLocked)),nS=(e,t,r,o)=>{let l=rx(e).rows,n=!0;for(let e=0;e<l.length;e++)for(let s=0;s<ry(l[0]);s++){let a=l[e],i=rw(a,s),m=r(i.element,t);m&&!n?rp(a,s,e0(o(),!0,i.isLocked)):m&&(n=!1)}return e},nT=e=>{let t=t=>t(e),r=h(e),o=()=>l,l={tag:!0,inner:e,fold:(t,r)=>r(e),isValue:C,isError:x,map:t=>nD.value(t(e)),mapError:o,bind:t,exists:t,forall:t,getOr:r,or:o,getOrThunk:r,orThunk:o,getOrDie:r,each:t=>{t(e)},toOptional:()=>S.some(e)};return l},nR=e=>{var t;let r=()=>o,o={tag:!1,inner:e,fold:(t,r)=>t(e),isValue:x,isError:C,map:r,mapError:t=>nD.error(t(e)),bind:r,exists:x,forall:C,getOr:p,or:p,getOrThunk:y,orThunk:y,getOrDie:(t=String(e),()=>{throw Error(t)}),each:g,toOptional:S.none};return o},nD={value:nT,error:nR,fromOption:(e,t)=>e.fold(()=>nR(t),nT)},nO=(e,t)=>({rowDelta:0,colDelta:ry(e[0])-ry(t[0])}),nk=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),nE=(e,t,r,o)=>{let l="colgroup"===t.section?r.col:r.cell;return E(e,e=>e0(l(),!0,o(e)))},nN=(e,t,r,o)=>{let l=e[e.length-1];return e.concat(E(t,()=>{let e="colgroup"===l.section?r.colgroup:r.row,t=rC(l,e,p),n=nE(t.cells.length,t,r,e=>Z(o,e.toString()));return rb(t,n)}))},nB=(e,t,r,o)=>N(e,e=>{let l=nE(t,e,r,x);return rg(e,o,l)}),n_=(e,t,r)=>{let o=t.colDelta<0?nB:p,l=t.rowDelta<0?nN:p,n=rR(e),s=ry(e[0]),a=k(n,e=>e===s-1),i=o(e,Math.abs(t.colDelta),r,a?s-1:s),m=rR(i);return l(i,Math.abs(t.rowDelta),r,F(m,C))},nz=(e,t,r,o)=>{let l=w(o,rw(e[t],r).element),n=e[t];return e.length>1&&ry(n)>1&&(r>0&&l(rv(n,r-1))||r<n.cells.length-1&&l(rv(n,r+1))||t>0&&l(rv(e[t-1],r))||t<e.length-1&&l(rv(e[t+1],r)))},nA=(e,t,r)=>z(r,r=>r>=e.column&&r<=ry(t[0])+e.column),nL=(e,t,r,o,l)=>{var n;n=o.cell,e>0&&e<t[0].cells.length&&B(t,t=>{let r=t.cells[e-1],o=0,s=n();for(;t.cells.length>e+o&&l(r.element,t.cells[e+o].element);)rp(t,e+o,e0(s,!0,t.cells[e+o].isLocked)),o++});let s=nk(r,t),a=n_(r,s,o),i=nk(t,a);return N(n_(t,i,o),(t,r)=>rg(t,e,a[r].cells))},nW=(e,t,r,o,l)=>{((e,t,r,o)=>{let l=rx(e).rows;t>0&&t<l.length&&B(L(l[t-1].cells,(e,t)=>k(e,e=>r(e.element,t.element))?e:e.concat([t]),[]),e=>{let n=S.none();for(let s=t;s<l.length;s++)for(let t=0;t<ry(l[0]);t++){let a=l[s],i=rw(a,t);r(i.element,e.element)&&(n.isNone()&&(n=S.some(o())),n.each(e=>{rp(a,t,e0(e,!0,i.isLocked))}))}})})(t,e,l,o.cell);let n=rR(t),s=nO(t,r),a=n_(t,{...s,colDelta:s.colDelta-n.length},o),{cols:i,rows:m}=rx(a),d=rR(a),c=nO(r,t),u={...c,colDelta:c.colDelta+d.length},f=n_(N(r,e=>L(d,(t,r)=>rh(t,r,nE(1,e,o,C)[0]),e)),u,o);return[...i,...m.slice(0,e),...f,...m.slice(e,m.length)]},nM=(e,t,r,o,l)=>{let{rows:n,cols:s}=rx(e),a=n.slice(0,t),i=n.slice(t);return[...s,...a,rC(n[r],e=>l(e,o),(e,r)=>t>0&&t<n.length&&o(rv(n[t-1],r),rv(n[t],r))?rw(n[t],r):e0(l(e.element,o),!0,e.isLocked)),...i]},nj=(e,t,r,o,l)=>N(e,e=>{let n=t>0&&t<ry(e)&&o(rv(e,t-1),rv(e,t)),s="colgroup"!==e.section&&n?rw(e,t):e0(l(rw(e,r).element,o),!0,!1);return rh(e,t,s)}),nP=(e,t,r,o)=>{var l;return void 0!==rv(e[t],r)&&t>0&&o(rv(e[t-1],r),rv(e[t],r))||(l=e[t],r>0&&o(rv(l,r-1),rv(l,r)))},nI=(e,t,r,o)=>{let l=e=>("row"===e?tO(t,"rowspan")>1:tk(t))?`${e}group`:e;return e?l6(t)?l(r):null:o&&l6(t)?l("row"===r?"col":"row"):null},nF=(e,t,r)=>e0(r(e.element,t),!0,e.isLocked),nH=(e,t,r,o,l,n,s)=>N(e,(e,a)=>((e,i)=>{let m=N(e.cells,(e,i)=>{if(k(t,t=>r(e.element,t.element))){let t=s(e,a,i)?l(e,r,o):e;return n(t,a,i).each(e=>{var r;r=t.element,K({scope:S.from(e)},(e,t)=>{e.fold(()=>{ev(r,t)},e=>{eg(r.dom,t,e)})})}),t}return e});return e1(e.element,m,e.section,e.isNew)})(e)),n$=(e,t,r)=>P(e,(o,l)=>nP(e,l,t,r)?[]:[rw(o,t)]),nV=(e,t,r,o,l)=>{let n=rx(e).rows,s=P(t,e=>n$(n,e,o)),a=N(n,e=>l8(e.cells)),i=I(a,p)&&l8(s)?C:(e,t,r)=>!("th"===el(e.element)&&a[t]);return nH(e,s,o,l,nF,(e,t)=>S.some(nI(r,e.element,"row",a[t])),i)},nq=(e,t,r,o)=>{let l=rx(e).rows;return nH(e,N(t,e=>rw(l[e.row],e.column)),r,o,nF,S.none,C)},nU=e=>{if(!a(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],r={};return B(e,(o,l)=>{let n=U(o);if(1!==n.length)throw Error("one and only one name per case");let s=n[0],i=o[s];if(void 0!==r[s])throw Error("duplicate key detected:"+s);if("cata"===s)throw Error("cannot have a case named cata (sorry)");if(!a(i))throw Error("case arguments must be an array");t.push(s),r[s]=(...r)=>{let o=r.length;if(o!==i.length)throw Error("Wrong number of arguments to case "+s+". Expected "+i.length+" ("+i+"), got "+o);return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[l].apply(null,r)},match:e=>{let o=U(e);if(t.length!==o.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));if(!I(t,e=>O(o,e)))throw Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return e[s].apply(null,r)},log:e=>{console.log(e,{constructors:t,constructor:s,params:r})}}}}),r},nG={...nU([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},nK=(e,t,r)=>{B(rA(e)?N(rz(e),(e,r)=>({element:e.element,width:t[r],colspan:e.colspan})):N(r_(e),e=>{let r=((e,t,r)=>{let o=0;for(let l=e;l<t;l++)o+=void 0!==r[l]?r[l]:0;return o})(e.column,e.column+e.colspan,t);return{element:e.element,width:r,colspan:e.colspan}}),e=>{r.setElementWidth(e.element,e.width)})},nY=(e,t,r,o,l)=>{let n=rE(e),s=l.getCellDelta(t),a=l.getWidths(n,l),i=r===n.grid.columns-1,m=o.clampTableDelta(a,r,s,l.minCellWidth(),i),d=((e,t,r,o,l)=>{let n=e.slice(0),s=0===e.length?nG.none():1===e.length?nG.only(0):0===t?nG.left(0,1):t===e.length-1?nG.right(t-1,t):t>0&&t<e.length-1?nG.middle(t-1,t,t+1):nG.none(),a=h(N(n,h(0)));return s.fold(a,e=>o.singleColumnWidth(n[e],r),(e,t)=>l.calcLeftEdgeDeltas(n,e,t,r,o.minCellWidth(),o.isRelative),(e,t,s)=>l.calcMiddleDeltas(n,e,t,s,r,o.minCellWidth(),o.isRelative),(e,t)=>l.calcRightEdgeDeltas(n,e,t,r,o.minCellWidth(),o.isRelative))})(a,r,m,l,o);nK(n,N(d,(e,t)=>e+a[t]),l),o.resizeTable(l.adjustTableWidth,m,i)},nJ=(e,t,r)=>{let o=rE(e),l=N(oS(o,e,ou,e=>e.getOrThunk(tB)),(e,o)=>r===o?Math.max(t+e,tB()):e);B(N(o.all,(e,t)=>({element:e.element,height:l[t]})),e=>{os(e.element,e.height)}),B(r_(o),e=>{tR(e.element,"height")}),os(e,A(l,(e,t)=>e+t,0))},nQ=e=>L(e,(e,t)=>k(e,e=>e.column===t.column)?e:e.concat([t]),[]).sort((e,t)=>e.column-t.column),nX=ef("col"),nZ=ef("colgroup"),n0=e=>"tr"===el(e)||nZ(e),n1=e=>({element:e,colspan:tD(e,"colspan",1),rowspan:tD(e,"rowspan",1)}),n9=e=>ew(e,"scope").map(e=>e.substr(0,3)),n3=(e,t=n1)=>{let r=r=>{var l,n;if(n0(r))return nZ((l={element:r}).element)?e.colgroup(l):e.row(l);{let l=nX((n=t(r)).element)?e.col(n):e.cell(n);return o=S.some({item:r,replacement:l}),l}},o=S.none();return{getOrInit:(e,t)=>o.fold(()=>r(e),o=>t(e,o.item)?o.replacement:r(e))}},n5=e=>t=>{let r=[],o=o=>{let l=t.replace(o,e,"td"===e?{scope:null}:{});return r.push({item:o,sub:l}),l};return{replaceOrInit:(e,t)=>n0(e)||nX(e)?e:W(r,r=>t(r.item,e)).fold(()=>o(e),r=>t(e,r.item)?r.sub:o(e))}},n2=e=>({unmerge:t=>{let r=n9(t);return r.each(e=>eh(t,"scope",e)),()=>{let o=e.cell({element:t,colspan:1,rowspan:1});return tR(o,"width"),tR(t,"width"),r.each(e=>eh(o,"scope",e)),o}},merge:e=>(tR(e[0],"width"),(()=>{let t=td(N(e,n9));if(0===t.length)return S.none();{let e=t[0],r=["row","col"];return k(t,t=>t!==e&&O(r,t))?S.none():S.from(e)}})().fold(()=>ev(e[0],"scope"),t=>eh(e[0],"scope",t+"group")),h(e[0]))}),n7=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],n4=lS(),n6=e=>O(n7,n4.property().name(e)),n8=e=>O(["ol","ul"],n4.property().name(e)),se=e=>{let t=ef("br"),r=e=>oM(e).bind(r=>{let o=eA(r).map(e=>!!n6(e)||!!O(["br","img","hr","input"],n4.property().name(e))&&"img"!==el(e)).getOr(!1);return eN(r).map(l=>!0===o||"li"===el(l)||to(l,n8).isSome()||t(r)||n6(l)&&!eD(e,l)?[]:[eC.fromTag("br")])}).getOr([]),o=(()=>{let o=P(e,e=>{let o=eL(e);return I(o,e=>t(e)||ed(e)&&0===oN(e).trim().length)?[]:o.concat(r(e))});return 0===o.length?[eC.fromTag("br")]:o})();eV(e[0]),e$(e[0],o)},st=e=>lr(e,!0),sr=e=>{0===tL(e).length&&eq(e)},so=(e,t)=>({grid:e,cursor:t}),sl=(e,t,r)=>{let o=((e,t,r)=>{var o,l;let n=rx(e).rows;return S.from(null===(l=null===(o=n[t])||void 0===o?void 0:o.cells[r])||void 0===l?void 0:l.element).filter(st).orThunk(()=>q(n,e=>q(e.cells,e=>{let t=e.element;return tc(st(t),t)})))})(e,t,r);return so(e,o)},sn=e=>L(e,(e,t)=>k(e,e=>e.row===t.row)?e:e.concat([t]),[]).sort((e,t)=>e.row-t.row),ss=(e,t)=>(r,o,l,n,s)=>sl(((e,t,r,o,l,n,s)=>{let{cols:a,rows:i}=rx(e),m=i[t[0]],d=P(t,e=>P(i[e].cells,(t,r)=>nP(i,e,r,l)?[]:[t])),c=N(m.cells,(e,t)=>l8(n$(i,t,l))),u=[...i];B(t,e=>{u[e]=s.transformRow(i[e],r)});let f=[...a,...u],g=I(c,p)&&l8(m.cells)?C:(e,t,r)=>!("th"===el(e.element)&&c[r]);return nH(f,d,l,n,s.transformCell,(e,t,r)=>S.some(nI(o,e.element,"col",c[r])),g)})(r,N(sn(o),e=>e.row),e,t,l,n.replaceOrInit,s),o[0].row,o[0].column),sa=ss("thead",!0),si=ss("tbody",!1),sm=ss("tfoot",!1),sd=(e,t,r)=>{var o;return ng(rk((o=r.section,tI(e,()=>o))),t,!0)},sc=(e,t,r,o)=>((e,t,r,o)=>{let l=rk(t),n=o.getWidths(l,o);nK(l,n,o)})(0,t,0,o.sizing),su=(e,t,r,o)=>((e,t,r,o,l)=>{let n=rk(t),s=o.getWidths(n,o),a=o.pixelWidth(),{newSizes:i,delta:m}=l.calcRedestributedWidths(s,a,r.pixelDelta,o.isRelative);nK(n,i,o),o.adjustTableWidth(m)})(0,t,r,o.sizing,o.resize),sf=(e,t)=>k(t,e=>0===e.column&&e.isLocked),sg=(e,t)=>k(t,t=>t.column+t.colspan>=e.grid.columns&&t.isLocked),sh=(e,t)=>{let r=rW(e);return L(nQ(t),(e,t)=>e+r[t.column].map(ru).getOr(0),0)},sp=e=>(t,r)=>ny(t,r).filter(r=>!(e?sf:sg)(t,r)).map(e=>({details:e,pixelDelta:sh(t,e)})),sb=e=>(t,r)=>nv(t,r).filter(r=>!(e?sf:sg)(t,r.cells)),sw=n5("th"),sv=n5("td"),sy=nw((e,t,r,o)=>{let l=t[0].row;return sl(A(sn(t),(e,t)=>({grid:nM(e.grid,l,t.row+e.delta,r,o.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid,l,t[0].column)},ny,g,g,n3),sx=nw((e,t,r,o)=>{let l=sn(t),n=l[l.length-1],s=n.row+n.rowspan;return sl(A(l,(e,t)=>nM(e,s,t.row,r,o.getOrInit),e),s,t[0].column)},ny,g,g,n3),sC=nw((e,t,r,o)=>{let l=t.details,n=nQ(l),s=n[0].column;return sl(A(n,(e,t)=>({grid:nj(e.grid,s,t.column+e.delta,r,o.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid,l[0].row,s)},sp(!0),su,g,n3),sS=nw((e,t,r,o)=>{let l=t.details,n=l[l.length-1],s=n.column+n.colspan;return sl(A(nQ(l),(e,t)=>nj(e,s,t.column,r,o.getOrInit),e),l[0].row,s)},sp(!1),su,g,n3),sT=nw((e,t,r,o)=>{var l;let n=nQ(t.details),s=(l=N(n,e=>e.column),P(e,e=>{let t=A(l,(e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,e.cells);return t.length>0?[e1(e.element,t,e.section,e.isNew)]:[]})),a=s.length>0?s[0].cells.length-1:0;return sl(s,n[0].row,Math.min(n[0].column,a))},(e,t)=>nx(e,t).map(t=>({details:t,pixelDelta:-sh(e,t)})),su,sr,n3),sR=nw((e,t,r,o)=>{let l=sn(t),n=((e,t,r)=>{let{rows:o,cols:l}=rx(e);return[...l,...o.slice(0,t),...o.slice(r+1)]})(e,l[0].row,l[l.length-1].row),s=Math.max(rx(n).rows.length-1,0);return sl(n,Math.min(t[0].row,s),t[0].column)},ny,g,sr,n3),sD=nw((e,t,r,o)=>sl(nV(e,N(nQ(t),e=>e.column),!0,r,o.replaceOrInit),t[0].row,t[0].column),nx,g,g,sw),sO=nw((e,t,r,o)=>sl(nV(e,N(nQ(t),e=>e.column),!1,r,o.replaceOrInit),t[0].row,t[0].column),nx,g,g,sv),sk=nw(sa,nx,g,g,sw),sE=nw(si,nx,g,g,sv),sN=nw(sm,nx,g,g,sv),sB=nw((e,t,r,o)=>sl(nq(e,t,r,o.replaceOrInit),t[0].row,t[0].column),nx,g,g,sw),s_=nw((e,t,r,o)=>sl(nq(e,t,r,o.replaceOrInit),t[0].row,t[0].column),nx,g,g,sv),sz=nw((e,t,r,o)=>{let l=t.cells;return se(l),so(((e,t,r,o)=>{let l=rx(e).rows;if(0===l.length)return e;for(let e=t.startRow;e<=t.finishRow;e++)for(let r=t.startCol;r<=t.finishCol;r++){let t=l[e],n=rw(t,r).isLocked;rp(t,r,e0(o(),!1,n))}return e})(e,t.bounds,0,o.merge(l)),S.from(l[0]))},(e,t)=>(0,t.mergable).filter(t=>nC(e,t.cells)),sc,g,n2),sA=nw((e,t,r,o)=>so(A(t,(e,t)=>nS(e,t,r,o.unmerge(t)),e),S.from(t[0])),(e,t)=>(0,t.unmergable).filter(t=>nC(e,t)),sc,g,n2),sL=nw((e,t,r,o)=>{var l,n;let s=(l=t.clipboard,n=t.generators,ng(rE(l),n,!0));return((e,t,r,o,l)=>{let n=rR(t),s=((e,t,r)=>{let o=ry(t[0]);return{row:rx(t).cols.length+e.row,column:W(E(o-e.column,t=>t+e.column),e=>I(r,t=>t!==e)).getOr(o-1)}})(e,t,n),a=rx(r).rows,i=nA(s,a,n);return((e,t,r)=>{if(e.row>=t.length||e.column>ry(t[0]))return nD.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);let o=t.slice(e.row),l=o[0].cells.slice(e.column),n=ry(r[0]),s=r.length;return nD.value({rowDelta:o.length-s,colDelta:l.length-n})})(s,t,a).map(e=>{let r=n_(t,{...e,colDelta:e.colDelta-i.length},o),n=nA(s,a,rR(r));return((e,t,r,o,l,n)=>{let s=e.row,a=e.column,i=s+r.length,m=a+ry(r[0])+n.length,d=F(n,C);for(let e=s;e<i;e++){let n=0;for(let i=a;i<m;i++){if(d[i]){n++;continue}nz(t,e,i,l)&&nS(t,rv(t[e],i),l,o.cell);let m=i-a-n,c=rw(r[e-s],m),u=c.element,f=o.replace(u);rp(t[e],i,e0(f,!0,c.isLocked))}}return t})(s,r,a,o,l,n)})})({row:t.row,column:t.column},e,s,t.generators,r).fold(()=>so(e,S.some(t.element)),e=>sl(e,t.row,t.column))},(e,t)=>tA(t.element).bind(r=>np(e,r).map(e=>({...e,generators:t.generators,clipboard:t.clipboard}))),sc,g,n3),sW=nw((e,t,r,o)=>{let l=rx(e).rows,n=t.cells[0].column,s=l[t.cells[0].row];return sl(nL(n,e,sd(t.clipboard,t.generators,s),t.generators,r),t.cells[0].row,t.cells[0].column)},sb(!0),g,g,n3),sM=nw((e,t,r,o)=>{let l=rx(e).rows,n=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,s=l[t.cells[0].row];return sl(nL(n,e,sd(t.clipboard,t.generators,s),t.generators,r),t.cells[0].row,n)},sb(!1),g,g,n3),sj=nw((e,t,r,o)=>{let l=rx(e).rows,n=t.cells[0].row,s=l[n];return sl(nW(n,e,sd(t.clipboard,t.generators,s),t.generators,r),t.cells[0].row,t.cells[0].column)},nv,g,g,n3),sP=nw((e,t,r,o)=>{let l=rx(e).rows,n=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,s=l[t.cells[0].row];return sl(nW(n,e,sd(t.clipboard,t.generators,s),t.generators,r),n,t.cells[0].column)},nv,g,g,n3),sI=(e,t)=>{let r=rE(e);return ny(r,t).bind(e=>{let t=e[e.length-1],o=e[0].column,l=t.column+t.colspan;return nr(j(N(r.all,e=>z(e.cells,e=>e.column>=o&&e.column<l))))}).getOr("")},sF=(e,t)=>ny(rE(e),t).bind(nr).getOr(""),sH=(e,t)=>{let r=rE(e);return ny(r,t).bind(e=>{let t=e[e.length-1],o=e[0].row,l=t.row+t.rowspan;return(e=>{let t=N(e,e=>nt(e).type),r=O(t,"header"),o=O(t,"footer");if(r||o){let e=O(t,"body");return!r||e||o?r||e||!o?S.none():S.some("footer"):S.some("header")}return S.some("body")})(r.all.slice(o,l))}).getOr("")},s$=(e,t)=>e.dispatch("NewRow",{node:t}),sV=(e,t)=>e.dispatch("NewCell",{node:t}),sq=(e,t,r)=>{e.dispatch("TableModified",{...r,table:t})},sU={structure:!1,style:!0},sG={structure:!0,style:!1},sK={structure:!0,style:!0},sY=(e,t)=>o3(e)?oR(t):o5(e)?oD(t):oO(t),sJ=(e,t,r)=>{let o=e=>"table"===el(ll(e)),l=oQ(e),n=o1(e)?g:lZ,s=t=>{switch(oX(e)){case"section":return nn();case"sectionCells":return ns();case"cells":return na();default:return((e,t)=>{switch(q(rE(e).all,e=>{let t=nt(e);return"header"===t.type?S.from(t.subType):S.none()}).getOr(t)){case"section":return nn();case"sectionCells":return ns();case"cells":return na()}})(t,"section")}},a=(o,n,a,i)=>(m,d,c=!1)=>{ls(m);let u=oU(a,eC.fromDom(e.getDoc()),l),f={sizing:sY(e,m),resize:o1(e)?l2():l7(),section:s(m)};return n(m)?o(m,d,u,f).bind(o=>{t.refresh(m.dom),B(o.newRows,t=>{s$(e,t.dom)}),B(o.newCells,t=>{sV(e,t.dom)});let l=o.cursor.fold(()=>$(tL(m)).filter(e7).map(t=>{r.clearSelectedCells(m.dom);let o=e.dom.createRng();return o.selectNode(t.dom),e.selection.setRng(o),eh(t,"data-mce-selected","1"),o}),t=>{let o=lQ(lX,t),l=e.dom.createRng();return l.setStart(o.element.dom,o.offset),l.setEnd(o.element.dom,o.offset),e.selection.setRng(l),r.clearSelectedCells(m.dom),S.some(l)});return e7(m)&&(ls(m),c||sq(e,m.dom,i)),l.map(e=>({rng:e,effect:i}))}):S.none()};return{deleteRow:a(sR,t=>!o(e)||l4(t).rows>1,g,sG),deleteColumn:a(sT,t=>!o(e)||l4(t).columns>1,g,sG),insertRowsBefore:a(sy,C,g,sG),insertRowsAfter:a(sx,C,g,sG),insertColumnsBefore:a(sC,C,n,sG),insertColumnsAfter:a(sS,C,n,sG),mergeCells:a(sz,C,g,sG),unmergeCells:a(sA,C,g,sG),pasteColsBefore:a(sW,C,g,sG),pasteColsAfter:a(sM,C,g,sG),pasteRowsBefore:a(sj,C,g,sG),pasteRowsAfter:a(sP,C,g,sG),pasteCells:a(sL,C,g,sK),makeCellsHeader:a(sB,C,g,sG),unmakeCellsHeader:a(s_,C,g,sG),makeColumnsHeader:a(sD,C,g,sG),unmakeColumnsHeader:a(sO,C,g,sG),makeRowsHeader:a(sk,C,g,sG),makeRowsBody:a(sE,C,g,sG),makeRowsFooter:a(sN,C,g,sG),getTableRowType:sH,getTableCellType:sF,getTableColType:sI}},sQ=(e,t,r)=>{let o=tD(e,t,1);1===r||o<=1?ev(e,t):eh(e,t,Math.min(r,o))},sX=(e,t)=>r=>{let o=r.column+r.colspan-1,l=r.column;return o>=e&&l<t},sZ=nU([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),s0=(e,t,r)=>{let o=r.substring(0,r.length-e.length),l=parseFloat(o);return o===l.toString()?t(l):sZ.invalid(r)},s1={...sZ,from:e=>th(e,"%")?s0("%",sZ.percent,e):th(e,"px")?s0("px",sZ.pixels,e):sZ.invalid(e)},s9=(e,t,r)=>{let o=s1.from(r);return s2(I(e,e=>"0px"===e)?((e,t)=>{let r=e.fold(()=>h(""),e=>h(e/t+"px"),()=>h(100/t+"%"));return E(t,r)})(o,e.length):o.fold(()=>e,r=>((e,t,r)=>{let o=r/t;return N(e,e=>s1.from(e).fold(()=>e,e=>e*o+"px",e=>e/100*r+"px"))})(e,t,r),r=>N(e,e=>s1.from(e).fold(()=>e,e=>e/t*100+"%",e=>e+"%"))))},s3=(e,t)=>0===e.length?t:A(e,(e,t)=>s1.from(t).fold(h(0),p,p)+e,0),s5=(e,t)=>s1.from(e).fold(h(e),e=>e+t+"px",e=>e+t+"%"),s2=e=>{if(0===e.length)return e;let t=A(e,(e,t)=>{let r=s1.from(t).fold(()=>({value:t,remainder:0}),e=>((e,t)=>{let r=Math.floor(e);return{value:r+"px",remainder:e-r}})(e),e=>({value:e+"%",remainder:0}));return{output:[r.value].concat(e.output),remainder:e.remainder+r.remainder}},{output:[],remainder:0}),r=t.output;return r.slice(0,r.length-1).concat([s5(r[r.length-1],Math.round(t.remainder))])},s7=s1.from,s4=(e,t,r)=>{let o=rE(e),l=o.all,n=r_(o),s=rz(o);t.each(t=>{let r=s7(t).fold(h("px"),h("px"),h("%")),l=rc(e),a=s9(oy(o,e,ob,ox),l,t);rA(o)?B(s,(e,t)=>{let o=s3([a[t]],tN());ty(e.element,"width",o+r)}):B(n,e=>{let t=s3(a.slice(e.column,e.colspan+e.column),tN());ty(e.element,"width",t+r)}),ty(e,"width",t)}),r.each(t=>{var r;let s=rH(e);r=s9(oS(o,e,ow,ox),s,t),B(n,e=>{tR(e.element,"height")}),B(l,(e,t)=>{ty(e.element,"height",r[t])}),ty(e,"height",t)})},s6=e=>om(e).exists(e=>r8.test(e)),s8=e=>om(e).exists(e=>oe.test(e)),ae=e=>om(e).isNone(),at=e=>{ev(e,"width"),ev(e,"height")},ar=e=>{let t=og(e);s4(e,S.some(t),S.none()),at(e)},ao=e=>{let t=rc(e)+"px";s4(e,S.some(t),S.none()),at(e)},al=e=>{tR(e,"width");let t=tW(e);B(t.length>0?t:tL(e),e=>{tR(e,"width"),at(e)}),at(e)},an={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},as=(e,t,r,o)=>E(e,e=>((e,t,r,o)=>{let l=eC.fromTag("tr");for(let n=0;n<e;n++){let e=eC.fromTag(o<t||n<r?"th":"td");n<r&&eh(e,"scope","row"),o<t&&eh(e,"scope","col"),eI(e,eC.fromTag("br")),eI(l,e)}return l})(t,r,o,e)),aa=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},ai=(e,t,r,o,l)=>{let s=(e=>{let t=e.options,r=t.get("table_default_styles");return t.isSet("table_default_styles")?r:o2(e)||!o4(e)?r:o5(e)?{...r,width:oJ(e)}:{...r,width:oY}})(e),a={styles:s,attributes:o8(e),colGroups:le(e)};return e.undoManager.ignore(()=>{let n=((e,t,r,o,l,n=an)=>{let s=eC.fromTag("table"),a="cells"!==l;tx(s,n.styles),ep(s,n.attributes),n.colGroups&&eI(s,(e=>{let t=eC.fromTag("colgroup");return E(e,()=>eI(t,eC.fromTag("col"))),t})(t));let i=Math.min(e,r);if(a&&r>0){let e=eC.fromTag("thead");eI(s,e),e$(e,as(r,t,"sectionCells"===l?i:0,o))}let m=eC.fromTag("tbody");return eI(s,m),e$(m,as(a?e-i:e,t,a?0:r,o)),s})(r,t,l,o,oX(e),a);eh(n,"data-mce-id","__mce");let s=(e=>{let t=eC.fromTag("div");return eI(t,eC.fromDom(e.dom.cloneNode(!0))),t.dom.innerHTML})(n);e.insertContent(s),e.addVisual()}),ta(ll(e),'table[data-mce-id="__mce"]').map(t=>{var r;return o5(e)?ao(t):o2(e)?al(t):(o3(e)||n(r=s.width)&&-1!==r.indexOf("%"))&&ar(t),ls(t),ev(t,"data-mce-id"),B(tt(t,"tr"),t=>{s$(e,t.dom),B(tt(t,"th,td"),t=>{sV(e,t.dom)})}),((e,t)=>{ta(t,"td,th").each(w(aa,e))})(e,t),t.dom}).getOrNull()};var am=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let ad="x-tinymce/dom-table-",ac=ad+"rows",au=ad+"columns",af=e=>{let t=am.FakeClipboardItem(e);am.write([t])},ag=e=>{var t;return q(null!==(t=am.read())&&void 0!==t?t:[],t=>S.from(t.getType(e)))},ah=e=>{ag(e).isSome()&&am.clear()},ap=e=>{e.fold(aw,e=>af({[ac]:e}))},ab=()=>ag(ac),aw=()=>ah(ac),av=e=>{e.fold(ax,e=>af({[au]:e}))},ay=()=>ag(au),ax=()=>ah(au),aC=e=>lV(la(e),ln(e)).filter(lf),aS=(e,t)=>{let r=ln(e),o=e=>tM(e,r),l=t=>lq(la(e),ln(e)).filter(lf).bind(e=>o(e).map(r=>t(r,e))),a=t=>{e.focus()},i=(t,r=!1)=>l((o,l)=>{let n=lH(lU(e),o,l);t(o,n,r).each(a)}),m=()=>l((t,r)=>((e,t,r)=>{let o=rE(e);return ny(o,t).bind(e=>{let t=nh(P(rx(ng(o,r,!1)).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),e=>{let t=z(e.cells,e=>!e.isLocked);return t.length>0?[{...e,cells:t}]:[]}));return tc(t.length>0,t)}).map(e=>N(e,e=>{let t=eK(e.element);return B(e.cells,e=>{let r=eY(e.element);nm(r,"colspan",e.colspan,1),nm(r,"rowspan",e.rowspan,1),eI(t,r)}),t}))})(t,lH(lU(e),t,r),oU(g,eC.fromDom(e.getDoc()),S.none()))),d=()=>l((t,r)=>((e,t)=>{let r=rE(e);return nx(r,t).map(e=>{let t=e[e.length-1],o=e[0].column,l=t.column+t.colspan;return[...((e,t,r)=>{if(rA(e)){let o=N(z(rz(e),sX(t,r)),e=>{let o=eY(e.element);return sQ(o,"span",r-t),o}),l=eC.fromTag("colgroup");return e$(l,o),[l]}return[]})(r,o,l),...N(r.all,e=>{let t=N(z(e.cells,sX(o,l)),e=>{let t=eY(e.element);return sQ(t,"colspan",l-o),t}),r=eC.fromTag("tr");return e$(r,t),r})]})})(t,lH(lU(e),t,r))),c=(t,r)=>r().each(r=>{let o=N(r,e=>eY(e));l((r,l)=>{let n=oG(eC.fromDom(e.getDoc()));t(r,{selection:p(lU(e)),clipboard:o,generators:n}).each(a)})}),u=e=>(t,r)=>{var o;return(Z(r,o="type")?S.from(r[o]):S.none()).each(t=>{i(e(t),r.no_events)})};K({mceTableSplitCells:()=>i(t.unmergeCells),mceTableMergeCells:()=>i(t.mergeCells),mceTableInsertRowBefore:()=>i(t.insertRowsBefore),mceTableInsertRowAfter:()=>i(t.insertRowsAfter),mceTableInsertColBefore:()=>i(t.insertColumnsBefore),mceTableInsertColAfter:()=>i(t.insertColumnsAfter),mceTableDeleteCol:()=>i(t.deleteColumn),mceTableDeleteRow:()=>i(t.deleteRow),mceTableCutCol:()=>d().each(e=>{av(e),i(t.deleteColumn)}),mceTableCutRow:()=>m().each(e=>{ap(e),i(t.deleteRow)}),mceTableCopyCol:()=>d().each(e=>av(e)),mceTableCopyRow:()=>m().each(e=>ap(e)),mceTablePasteColBefore:()=>c(t.pasteColsBefore,ay),mceTablePasteColAfter:()=>c(t.pasteColsAfter,ay),mceTablePasteRowBefore:()=>c(t.pasteRowsBefore,ab),mceTablePasteRowAfter:()=>c(t.pasteRowsAfter,ab),mceTableDelete:()=>aC(e).each(t=>{tM(t,r).filter(v(r)).each(t=>{let r=eC.fromText("");if(ej(t,r),eq(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{let t=e.dom.createRng();t.setStart(r.dom,0),t.setEnd(r.dom,0),e.selection.setRng(t),e.nodeChanged()}})}),mceTableCellToggleClass:(t,r)=>{l(t=>{let o=lU(e),l=I(o,t=>e.formatter.match("tablecellclass",{value:r},t.dom))?e.formatter.remove:e.formatter.apply;B(o,e=>l("tablecellclass",{value:r},e.dom)),sq(e,t.dom,sU)})},mceTableToggleClass:(t,r)=>{l(t=>{e.formatter.toggle("tableclass",{value:r},t.dom),sq(e,t.dom,sU)})},mceTableToggleCaption:()=>{aC(e).each(t=>{tM(t,r).each(r=>{ts(r,"caption").fold(()=>{let t=eC.fromTag("caption");eI(t,eC.fromText("Caption")),((e,t,r)=>{eW(e,0).fold(()=>{eI(e,t)},e=>{eM(e,t)})})(r,t),e.selection.setCursorLocation(t.dom,0)},o=>{ef("caption")(t)&&eR("td",r).each(t=>e.selection.setCursorLocation(t.dom,0)),eq(o)}),sq(e,r.dom,sG)})})},mceTableSizingMode:(t,o)=>aC(e).each(t=>{o2(e)||o5(e)||o3(e)||tM(t,r).each(t=>{"relative"!==o||s6(t)?"fixed"!==o||s8(t)?"responsive"!==o||ae(t)||al(t):ao(t):ar(t),ls(t),sq(e,t.dom,sG)})}),mceTableCellType:u(e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader),mceTableColType:u(e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader),mceTableRowType:u(e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}})},(t,r)=>e.addCommand(r,t)),e.addCommand("mceInsertTable",(t,r)=>{((e,t,r,o={})=>{let l=e=>f(e)&&e>0;if(l(t)&&l(r)){let l=o.headerRows||0;return ai(e,r,t,o.headerColumns||0,l)}console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")})(e,r.rows,r.columns,r.options)}),e.addCommand("mceTableApplyCellStyle",(t,r)=>{let l=e=>"tablecell"+e.toLowerCase().replace("-","");if(!s(r))return;let a=z(lU(e),lf);if(0===a.length)return;let i=((e,t)=>{var r;let o={};return r=(e,t)=>{o[t]=e},K(e,(e,o)=>{(t(e,o)?r:g)(e,o)}),o})(r,(t,r)=>e.formatter.has(l(r))&&n(t));(e=>{for(let t in e)if(G.call(e,t))return!1;return!0})(i)||(K(i,(t,r)=>{let o=l(r);B(a,r=>{""===t?e.formatter.remove(o,{value:null},r.dom,!0):e.formatter.apply(o,{value:t},r.dom)})}),o(a[0]).each(t=>sq(e,t.dom,sU)))})},aT=nU([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),aR={before:aT.before,on:aT.on,after:aT.after,cata:(e,t,r,o)=>e.fold(t,r,o),getStart:e=>e.fold(p,p,p)},aD=(e,t)=>({selection:e,kill:t}),aO=(e,t)=>{let r=e.document.createRange();return r.selectNode(t.dom),r},ak=(e,t)=>{let r=e.document.createRange();return aE(r,t),r},aE=(e,t)=>e.selectNodeContents(t.dom),aN=(e,t,r)=>{let o=e.document.createRange();return t.fold(e=>{o.setStartBefore(e.dom)},(e,t)=>{o.setStart(e.dom,t)},e=>{o.setStartAfter(e.dom)}),((e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,r)=>{e.setEnd(t.dom,r)},t=>{e.setEndAfter(t.dom)})})(o,r),o},aB=(e,t,r,o,l)=>{let n=e.document.createRange();return n.setStart(t.dom,r),n.setEnd(o.dom,l),n},a_=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),az=nU([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),aA=(e,t,r)=>t(eC.fromDom(r.startContainer),r.startOffset,eC.fromDom(r.endContainer),r.endOffset),aL=(e,t)=>((e,t)=>{let r=t.ltr();return r.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>az.rtl(eC.fromDom(e.endContainer),e.endOffset,eC.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>aA(0,az.ltr,r)):aA(0,az.ltr,r)})(0,t.match({domRange:e=>({ltr:h(e),rtl:S.none}),relative:(t,r)=>({ltr:t$(()=>aN(e,t,r)),rtl:t$(()=>S.some(aN(e,r,t)))}),exact:(t,r,o,l)=>({ltr:t$(()=>aB(e,t,r,o,l)),rtl:t$(()=>S.some(aB(e,o,l,t,r)))})})),aW=(e,t)=>aL(e,t).match({ltr:(t,r,o,l)=>{let n=e.document.createRange();return n.setStart(t.dom,r),n.setEnd(o.dom,l),n},rtl:(t,r,o,l)=>{let n=e.document.createRange();return n.setStart(o.dom,l),n.setEnd(t.dom,r),n}});az.ltr,az.rtl;let aM=(e,t,r,o)=>({start:e,soffset:t,finish:r,foffset:o}),aj=(e,t,r,o)=>({start:aR.on(e,t),finish:aR.on(r,o)}),aP=(e,t)=>{let r=aW(e,t);return aM(eC.fromDom(r.startContainer),r.startOffset,eC.fromDom(r.endContainer),r.endOffset)},aI=(e,t,r,o,l)=>eD(r,o)?S.none():lE(r,o,t).bind(t=>{let o=t.boxes.getOr([]);return o.length>1?(l(e,o,t.start,t.finish),S.some(aD(S.some(aj(r,0,r,oz(r))),!0))):S.none()}),aF=(e,t)=>({item:e,mode:t}),aH=(e,t,r,o=a$)=>e.property().parent(t).map(e=>aF(e,o)),a$=(e,t,r,o=aV)=>r.sibling(e,t).map(e=>aF(e,o)),aV=(e,t,r,o=aV)=>{let l=e.property().children(t);return r.first(l).map(e=>aF(e,o))},aq=[{current:aH,next:a$,fallback:S.none()},{current:a$,next:aV,fallback:S.some(aH)},{current:aV,next:aV,fallback:S.some(a$)}],aU=(e,t,r,o,l=aq)=>W(l,e=>e.current===r).bind(r=>r.current(e,t,o,r.next).orThunk(()=>r.fallback.bind(r=>aU(e,t,r,o)))),aG=(e,t,r,o,l,n)=>aU(e,t,o,l).bind(t=>n(t.item)?S.none():r(t.item)?S.some(t.item):aG(e,t.item,r,t.mode,l,n)),aK=e=>t=>0===e.property().children(t).length,aY=(e,t,r,o)=>aG(e,t,r,a$,{sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?S.some(e[e.length-1]):S.none()},o),aJ=(e,t,r,o)=>aG(e,t,r,a$,{sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?S.some(e[0]):S.none()},o),aQ=lS(),aX=(e,t)=>aY(aQ,e,aK(aQ),t),aZ=(e,t)=>aJ(aQ,e,aK(aQ),t),a0=nU([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),a1=e=>ti(e,"tr"),a9={...a0,verify:(e,t,r,o,l,n,s)=>ti(o,"td,th",s).bind(r=>ti(t,"td,th",s).map(t=>eD(r,t)?eD(o,r)&&oz(r)===l?n(t):a0.none("in same cell"):lO(a1,[r,t]).fold(()=>((e,t,r)=>{let o=e.getRect(t),l=e.getRect(r);return l.right>o.left&&l.left<o.right})(e,t,r)?a0.success():n(t),e=>n(t)))).getOr(a0.none("default")),cata:(e,t,r,o,l)=>e.fold(t,r,o,l)},a3=ef("br"),a5=(e,t,r)=>t(e,r).bind(e=>ed(e)&&0===oN(e).trim().length?a5(e,t,r):S.some(e)),a2=(e,t,r,o)=>eW(t,r).filter(a3).orThunk(()=>eW(t,r-1).filter(a3)).bind(t=>o.traverse(t).fold(()=>a5(t,o.gather,e).map(o.relative),e=>eN(e).bind(t=>{let r=eL(t);return M(r,w(eD,e)).map(o=>({parent:t,children:r,element:e,index:o}))}).map(e=>aR.on(e.parent,e.index)))),a7=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),a4=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),a6=(e,t,r)=>({left:e.left+t,top:e.top+r,right:e.right+t,bottom:e.bottom+r}),a8=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),ie=(e,t)=>S.some(e.getRect(t)),it=(e,t,r)=>em(t)?ie(e,t).map(a8):ed(t)?(r>=0&&r<oz(t)?e.getRangedRect(t,r,t,r+1):r>0?e.getRangedRect(t,r-1,t,r):S.none()).map(a8):S.none(),ir=(e,t)=>em(t)?ie(e,t).map(a8):ed(t)?e.getRangedRect(t,0,t,oz(t)).map(a8):S.none(),io=nU([{none:[]},{retry:["caret"]}]),il=(e,t,r)=>tl(t,n6).fold(x,t=>ir(e,t).exists(e=>r.left<e.left||1>Math.abs(e.right-r.left)||r.left>e.right)),is=(e,t,r,o,l)=>{var n,s;return 0===l?S.some(o):(n=o.left,s=t.point(o),e.elementFromPoint(n,s).filter(e=>"table"===el(e)).isSome())?is(e,t,r,t.move(o,5),l-1):e.situsFromPoint(o.left,t.point(o)).bind(n=>n.start.fold(S.none,n=>ir(e,n).bind(s=>t.adjuster(e,n,s,r,o).fold(S.none,o=>is(e,t,r,o,l-1))).orThunk(()=>S.some(o)),S.none))},ia=(e,t,r)=>{let o=e.move(r,5),l=is(t,e,r,o,100).getOr(o);return(e.point(l)>t.getInnerHeight()?S.some(e.point(l)-t.getInnerHeight()):0>e.point(l)?S.some(-e.point(l)):S.none()).fold(()=>t.situsFromPoint(l.left,e.point(l)),r=>(t.scrollBy(0,r),t.situsFromPoint(l.left,e.point(l)-r)))},ii={tryUp:w(ia,{point:e=>e.top,adjuster:(e,t,r,o,l)=>{let n=a4(l,5);return 1>Math.abs(r.top-o.top)||r.bottom<l.top?io.retry(n):r.bottom===l.top?io.retry(a4(l,1)):il(e,t,l)?io.retry(a6(n,5,0)):io.none()},move:a4,gather:aX}),tryDown:w(ia,{point:e=>e.bottom,adjuster:(e,t,r,o,l)=>{let n=a7(l,5);return 1>Math.abs(r.bottom-o.bottom)||r.top>l.bottom?io.retry(n):r.top===l.bottom?io.retry(a7(l,1)):il(e,t,l)?io.retry(a6(n,5,0)):io.none()},move:a7,gather:aZ}),getJumpSize:h(5)},im=(e,t,r)=>e.getSelection().bind(o=>{var l,n;return(l=o.finish,n=o.foffset,(a3(l)?r.traverse(l).orThunk(()=>a5(l,r.gather,t)).map(r.relative):a2(t,l,n,r)).map(e=>({start:e,finish:e}))).fold(()=>S.some(lK(o.finish,o.foffset)),l=>{var n;let s=e.fromSitus(l);return n=a9.verify(e,o.finish,o.foffset,s.finish,s.foffset,r.failure,t),a9.cata(n,e=>S.none(),()=>S.none(),e=>S.some(lK(e,0)),e=>S.some(lK(e,oz(e))))})}),id=(e,t,r,o,l,n)=>0===n?S.none():ig(e,t,r,o,l).bind(s=>{let a=e.fromSitus(s),i=a9.verify(e,r,o,a.finish,a.foffset,l.failure,t);return a9.cata(i,()=>S.none(),()=>S.some(s),s=>eD(r,s)&&0===o?ic(e,r,o,a4,l):id(e,t,s,0,l,n-1),s=>eD(r,s)&&o===oz(s)?ic(e,r,o,a7,l):id(e,t,s,oz(s),l,n-1))}),ic=(e,t,r,o,l)=>it(e,t,r).bind(t=>iu(e,l,o(t,ii.getJumpSize()))),iu=(e,t,r)=>{let o=ra().browser;return o.isChromium()||o.isSafari()||o.isFirefox()?t.retry(e,r):S.none()},ig=(e,t,r,o,l)=>it(e,r,o).bind(t=>iu(e,l,t)),ih=(e,t,r,o,l)=>ti(o,"td,th",t).bind(o=>ti(o,"table",t).bind(n=>to(l,e=>eN(e).exists(e=>eD(e,n)),void 0).isSome()?im(e,t,r).bind(o=>id(e,t,o.element,o.offset,r,20).map(e.fromSitus)).bind(e=>ti(e.finish,"td,th",t).map(t=>({start:o,finish:t,range:e}))):S.none())),ip=(e,t,r,o,l,n)=>n(o,t).orThunk(()=>ih(e,t,r,o,l).map(e=>{let t=e.range;return aD(S.some(aj(t.start,t.soffset,t.finish,t.foffset)),!0)})),ib=(e,t)=>ti(e,"tr",t).bind(e=>ti(e,"table",t).bind(r=>eD(e,tt(r,"tr")[0])?aY(aQ,r,e=>oM(e).isSome(),t).map(e=>{let t=oz(e);return aD(S.some(aj(e,t,e,t)),!0)}):S.none())),iw=(e,t)=>ti(e,"tr",t).bind(e=>ti(e,"table",t).bind(r=>{let o=tt(r,"tr");return eD(e,o[o.length-1])?aJ(aQ,r,e=>oW(e).isSome(),t).map(e=>aD(S.some(aj(e,0,e,0)),!0)):S.none()})),iv=(e,t,r,o,l,n,s)=>ih(e,r,o,l,n).bind(e=>aI(t,r,e.start,e.finish,s)),iy=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},ix=()=>{let e=(e=>{let t=iy(S.none()),r=()=>t.get().each(e);return{clear:()=>{r(),t.set(S.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{r(),t.set(S.some(e))}}})(g);return{...e,on:t=>e.get().each(t)}},iC=(e,t)=>ti(e,"td,th",t),iS=e=>eB(e).exists(lr),iT={traverse:eA,gather:aZ,relative:aR.before,retry:ii.tryDown,failure:a9.failedDown},iR={traverse:ez,gather:aX,relative:aR.before,retry:ii.tryUp,failure:a9.failedUp},iD=e=>t=>t===e,iO=iD(38),ik=iD(40),iE=e=>e>=37&&e<=40,iN={isBackward:iD(37),isForward:iD(39)},iB={isBackward:iD(39),isForward:iD(37)},i_=nU([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),iz={domRange:i_.domRange,relative:i_.relative,exact:i_.exact,exactFromRange:e=>i_.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{let t=e.match({domRange:e=>eC.fromDom(e.startContainer),relative:(e,t)=>aR.getStart(e),exact:(e,t,r,o)=>e});return eC.fromDom(eE(t).dom.defaultView)},range:aM},iA=document.caretPositionFromPoint?(e,t,r)=>{var o,l;return S.from(null===(l=(o=e.dom).caretPositionFromPoint)||void 0===l?void 0:l.call(o,t,r)).bind(t=>{if(null===t.offsetNode)return S.none();let r=e.dom.createRange();return r.setStart(t.offsetNode,t.offset),r.collapse(),S.some(r)})}:document.caretRangeFromPoint?(e,t,r)=>{var o,l;return S.from(null===(l=(o=e.dom).caretRangeFromPoint)||void 0===l?void 0:l.call(o,t,r))}:S.none,iL=(e,t)=>{let r=el(e);return"input"===r?aR.after(e):O(["br","img"],r)?0===t?aR.before(e):aR.after(e):aR.on(e,t)},iW=e=>S.from(e.getSelection()),iM=(e,t)=>{iW(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},ij=(e,t,r,o,l)=>{let n=aB(e,t,r,o,l);iM(e,n)},iP=(e,t)=>aL(e,t).match({ltr:(t,r,o,l)=>{ij(e,t,r,o,l)},rtl:(t,r,o,l)=>{iW(e).each(n=>{if(n.setBaseAndExtent)n.setBaseAndExtent(t.dom,r,o.dom,l);else if(n.extend)try{n.collapse(t.dom,r),n.extend(o.dom,l)}catch(n){ij(e,o,l,t,r)}else ij(e,o,l,t,r)})}}),iI=(e,t,r,o,l)=>{iP(e,((e,t,r,o)=>{let l=iL(e,t),n=iL(r,o);return iz.relative(l,n)})(t,r,o,l))},iF=(e,t,r)=>{iP(e,((e,t)=>{let r=e.fold(aR.before,iL,aR.after),o=t.fold(aR.before,iL,aR.after);return iz.relative(r,o)})(t,r))},iH=e=>{if(e.rangeCount>0){let t=e.getRangeAt(0),r=e.getRangeAt(e.rangeCount-1);return S.some(aM(eC.fromDom(t.startContainer),t.startOffset,eC.fromDom(r.endContainer),r.endOffset))}return S.none()},i$=e=>{if(null===e.anchorNode||null===e.focusNode)return iH(e);{let t=eC.fromDom(e.anchorNode),r=eC.fromDom(e.focusNode);return((e,t,r,o)=>{let l=((e,t,r,o)=>{let l=ek(e).dom.createRange();return l.setStart(e.dom,t),l.setEnd(r.dom,o),l})(e,t,r,o),n=eD(e,r)&&t===o;return l.collapsed&&!n})(t,e.anchorOffset,r,e.focusOffset)?S.some(aM(t,e.anchorOffset,r,e.focusOffset)):iH(e)}},iV=(e,t,r=!0)=>{let o=(r?ak:aO)(e,t);iM(e,o)},iq=e=>iW(e).filter(e=>e.rangeCount>0).bind(i$).map(e=>iz.exact(e.start,e.soffset,e.finish,e.foffset)),iU=e=>({elementFromPoint:(t,r)=>eC.fromPoint(eC.fromDom(e.document),t,r),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,r,o,l)=>(e=>{let t=e.getClientRects(),r=t.length>0?t[0]:e.getBoundingClientRect();return r.width>0||r.height>0?S.some(r).map(a_):S.none()})(aW(e,iz.exact(t,r,o,l))),getSelection:()=>iq(e).map(t=>aP(e,t)),fromSitus:t=>aP(e,iz.relative(t.start,t.finish)),situsFromPoint:(t,r)=>iA(eC.fromDom(e.document),t,r).map(e=>aM(eC.fromDom(e.startContainer),e.startOffset,eC.fromDom(e.endContainer),e.endOffset)).map(e=>aj(e.start,e.soffset,e.finish,e.foffset)),clearSelection:()=>{(e=>{iW(e).each(e=>e.removeAllRanges())})(e)},collapseSelection:(t=!1)=>{iq(e).each(r=>r.fold(e=>e.collapse(t),(r,o)=>{let l=t?r:o;iF(e,l,l)},(r,o,l,n)=>{let s=t?r:l,a=t?o:n;iI(e,s,a,s,a)}))},setSelection:t=>{iI(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:(t,r)=>{iF(e,t,r)},selectNode:t=>{iV(e,t,!1)},selectContents:t=>{iV(e,t)},getInnerHeight:()=>e.innerHeight,getScrollY:()=>(e=>{let t=void 0!==e?e.dom:document;return rV(t.body.scrollLeft||t.documentElement.scrollLeft,t.body.scrollTop||t.documentElement.scrollTop)})(eC.fromDom(e.document)).top,scrollBy:(t,r)=>{((e,t,r)=>{let o=(void 0!==r?r.dom:document).defaultView;o&&o.scrollBy(e,t)})(t,r,eC.fromDom(e.document))}}),iG=(e,t)=>({rows:e,cols:t}),iK=e=>tl(e,ei).exists(lr),iY=(e,t)=>iK(e)||iK(t),iJ=e=>void 0!==e.dom.classList,iQ=(e,t)=>((e,t,r)=>{let o=((e,t)=>{let r=eb(e,t);return void 0===r||""===r?[]:r.split(" ")})(e,t).concat([r]);return eh(e,t,o.join(" ")),!0})(e,"class",t),iX=(e,t)=>{iJ(e)?e.dom.classList.add(t):iQ(e,t)},iZ=(e,t)=>iJ(e)&&e.dom.classList.contains(t),i0=()=>({tag:"none"}),i1=e=>({tag:"multiple",elements:e}),i9=e=>({tag:"single",element:e}),i3=e=>{let t=eC.fromDom((e=>{if(e3()&&c(e.target)){let t=eC.fromDom(e.target);if(em(t)&&c(t.dom.shadowRoot)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return $(t)}}return S.from(e.target)})(e).getOr(e.target)),r=()=>e.stopPropagation(),o=()=>e.preventDefault();return{target:t,x:e.clientX,y:e.clientY,stop:r,prevent:o,kill:(...e)=>o(r.apply(null,e)),raw:e}},i5=(e,t,r,o)=>{e.dom.removeEventListener(t,r,o)},i2=(e,t,r)=>((e,t,r,o,l)=>{let n=e=>{r(e)&&o(i3(e))};return e.dom.addEventListener(t,n,l),{unbind:w(i5,e,t,n,l)}})(e,t,C,r,!1),i7=e=>!iZ(eC.fromDom(e.target),"ephox-snooker-resizer-bar"),i4=(e,t)=>{var r;let o=(r=lF.selectedSelector,{get:()=>lz(eC.fromDom(e.getBody()),r).fold(()=>lq(la(e),ln(e)).fold(i0,i9),i1)}),l=((e,t,r)=>{let o=t=>{ev(t,e.selected),ev(t,e.firstSelected),ev(t,e.lastSelected)},l=t=>{eh(t,e.selected,"1")},n=e=>{s(e),r()},s=t=>{B(tt(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`),o)};return{clearBeforeUpdate:s,clear:n,selectRange:(r,o,s,a)=>{n(r),B(o,l),eh(s,e.firstSelected,"1"),eh(a,e.lastSelected,"1"),t(o,s,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}})(lF,(t,r,o)=>{tM(r).each(l=>{let n=N(t,e=>e.dom),s=oQ(e),a=oU(g,eC.fromDom(e.getDoc()),s),i=((e,t,r)=>{let o=rE(e);return ny(o,t).map(e=>{let{rows:t}=rx(ng(o,r,!1));return{upOrLeftCells:P(nh(t.slice(0,e[e.length-1].row+1)),t=>N(t.cells.slice(0,e[e.length-1].column+1),e=>e.element)),downOrRightCells:P(nh(t.slice(e[0].row+e[0].rowspan-1,t.length)),t=>N(t.cells.slice(e[0].column+e[0].colspan-1,t.cells.length),e=>e.element))}})})(l,{selection:lU(e)},a).map(e=>Y(e,e=>N(e,e=>e.dom))).getOrUndefined();((e,t,r,o,l)=>{e.dispatch("TableSelectionChange",{cells:t,start:r,finish:o,otherCells:l})})(e,n,r.dom,o.dom,i)})},()=>(e=>{e.dispatch("TableSelectionClear")})(e));return e.on("init",r=>{let o=e.getWin(),n=ll(e),s=ln(e),a=((e,t,r,o)=>{let l=((e,t,r,o)=>{let l=ix(),n=l.clear,s=n=>{l.on(l=>{o.clearBeforeUpdate(t),iC(n.target,r).each(s=>{lE(l,s,r).each(r=>{let l=r.boxes.getOr([]);if(1===l.length){let r=l[0],s="false"===lo(r),a=tm(lt(n.target),r,eD);s&&a&&(o.selectRange(t,l,r,r),e.selectContents(r))}else l.length>1&&(o.selectRange(t,l,r.start,r.finish),e.selectContents(s))})})})};return{clearstate:n,mousedown:e=>{o.clear(t),iC(e.target,r).filter(iS).each(l.set)},mouseover:e=>{s(e)},mouseup:e=>{s(e),n()}}})(iU(e),t,r,o);return{clearstate:l.clearstate,mousedown:l.mousedown,mouseover:l.mouseover,mouseup:l.mouseup}})(o,n,s,l),i=((e,t,r,o)=>{let l=iU(e),n=()=>(o.clear(t),S.none());return{keydown:(e,s,a,i,m,d)=>{let c=e.raw,u=c.which,f=!0===c.shiftKey;return lN(t,o.selectedSelector).fold(()=>(iE(u)&&!f&&o.clearBeforeUpdate(t),iE(u)&&f&&!iY(s,i)?S.none:ik(u)&&f?w(iv,l,t,r,iT,i,s,o.selectRange):iO(u)&&f?w(iv,l,t,r,iR,i,s,o.selectRange):ik(u)?w(ip,l,r,iT,i,s,iw):iO(u)?w(ip,l,r,iR,i,s,ib):S.none),e=>{let r=r=>()=>q(r,r=>l_(e,r.rows,r.cols,o.firstSelectedSelector,o.lastSelectedSelector).map(e=>(o.clearBeforeUpdate(t),o.selectRange(t,e.boxes,e.start,e.finish),e.boxes))).fold(()=>lB(t,o.firstSelectedSelector,o.lastSelectedSelector).map(e=>{let r=ik(u)||d.isForward(u)?aR.after:aR.before;return l.setRelativeSelection(aR.on(e.first,0),r(e.table)),o.clear(t),aD(S.none(),!0)}),e=>S.some(aD(S.none(),!0)));return iE(u)&&f&&!iY(s,i)?S.none:ik(u)&&f?r([iG(1,0)]):iO(u)&&f?r([iG(-1,0)]):d.isBackward(u)&&f?r([iG(0,-1),iG(-1,0)]):d.isForward(u)&&f?r([iG(0,1),iG(1,0)]):iE(u)&&!f?n:S.none})()},keyup:(e,l,n,s,a)=>lN(t,o.selectedSelector).fold(()=>{var i;let m=e.raw,d=m.which;return!0===m.shiftKey&&iE(d)&&iY(l,s)?(i=o.selectRange,eD(l,s)&&n===a?S.none():ti(l,"td,th",r).bind(e=>ti(s,"td,th",r).bind(o=>aI(t,r,e,o,i)))):S.none()},S.none)}})(o,n,s,l),m=((e,t,r,o)=>{let l=iU(e);return(e,n)=>{o.clearBeforeUpdate(t),lE(e,n,r).each(e=>{let r=e.boxes.getOr([]);o.selectRange(t,r,e.start,e.finish),l.selectContents(n),l.collapseSelection()})}})(o,n,s,l);e.on("TableSelectorChange",e=>m(e.start,e.finish));let d=(t,r)=>{!0===t.raw.shiftKey&&(r.kill&&t.kill(),r.selection.each(t=>{let r=aW(o,iz.relative(t.start,t.finish));e.selection.setRng(r)}))},c=e=>0===e.button,u=(()=>{let e=iy(eC.fromDom(n)),t=iy(0);return{touchEnd:r=>{let o=eC.fromDom(r.target);if(ef("td")(o)||ef("th")(o)){let l=e.get(),n=t.get();eD(l,o)&&r.timeStamp-n<300&&(r.preventDefault(),m(o,o))}e.set(o),t.set(r.timeStamp)}}})();e.on("dragstart",e=>{a.clearstate()}),e.on("mousedown",e=>{c(e)&&i7(e)&&a.mousedown(i3(e))}),e.on("mouseover",e=>{(void 0===e.buttons||0!=(1&e.buttons))&&i7(e)&&a.mouseover(i3(e))}),e.on("mouseup",e=>{c(e)&&i7(e)&&a.mouseup(i3(e))}),e.on("touchend",u.touchEnd),e.on("keyup",t=>{let r=i3(t);if(r.raw.shiftKey&&iE(r.raw.which)){let t=e.selection.getRng(),o=eC.fromDom(t.startContainer),l=eC.fromDom(t.endContainer);i.keyup(r,o,t.startOffset,l,t.endOffset).each(e=>{d(r,e)})}}),e.on("keydown",r=>{let o=i3(r);t.hide();let l=e.selection.getRng(),n=eC.fromDom(l.startContainer),s=eC.fromDom(l.endContainer),a=rP(iN,iB)(eC.fromDom(e.selection.getStart()));i.keydown(o,n,l.startOffset,s,l.endOffset,a).each(e=>{d(o,e)}),t.show()}),e.on("NodeChange",()=>{let t=e.selection;lO(tM,[eC.fromDom(t.getStart()),eC.fromDom(t.getEnd())]).fold(()=>l.clear(n),g)})}),e.on("PreInit",()=>{e.serializer.addTempAttr(lF.firstSelected),e.serializer.addTempAttr(lF.lastSelected)}),{getSelectedCells:()=>((e,t,r,o)=>{switch(e.tag){case"none":return t();case"single":return[e.element.dom];case"multiple":return N(e.elements,e=>e.dom)}})(o.get(),h([])),clearSelectedCells:e=>l.clear(eC.fromDom(e))}},i6=e=>{let t=[];return{bind:e=>{if(void 0===e)throw Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=z(t,t=>t!==e)},trigger:(...r)=>{let o={};B(e,(e,t)=>{o[e]=r[t]}),B(t,e=>{e(o)})}}},i8=e=>({registry:Y(e,e=>({bind:e.bind,unbind:e.unbind})),trigger:Y(e,e=>e.trigger)}),me=e=>e.slice(0).sort(),mt=(e,t)=>{let r=z(t,t=>!O(e,t));r.length>0&&(e=>{throw Error("Unsupported keys for object: "+me(e).join(", "))})(r)},mr=e=>((e,t,r)=>{if(0===t.length)throw Error("You must specify at least one required field.");return((e,t)=>{if(!a(t))throw Error("The "+e+" fields must be an array. Was: "+t+".");B(t,t=>{if(!n(t))throw Error("The value "+t+" in the "+e+" fields was not a string.")})})("required",t),(e=>{let t=me(e);W(t,(e,r)=>r<t.length-1&&e===t[r+1]).each(e=>{throw Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})})(t),o=>{let l=U(o);I(t,e=>O(l,e))||((e,t)=>{throw Error("All required keys ("+me(e).join(", ")+") were not specified. Specified keys were: "+me(t).join(", ")+".")})(t,l),e(t,l);let n=z(t,e=>!r.validate(o[e],e));return n.length>0&&((e,t)=>{throw Error("All values need to be of type: "+t+". Keys ("+me(e).join(", ")+") were not.")})(n,r.label),o}})(mt,e,{validate:u,label:"function"}),mo=mr(["compare","extract","mutate","sink"]),ml=mr(["element","start","stop","destroy"]),mn=mr(["forceDrop","drop","move","delayDrop"]),ms=()=>{let e={onEvent:g,reset:g,events:i8({move:i6(["info"])}).registry},t=(()=>{let e=S.none(),t=i8({move:i6(["info"])});return{onEvent:(r,o)=>{o.extract(r).each(r=>{((t,r)=>{let o=e.map(e=>t.compare(e,r));return e=S.some(r),o})(o,r).each(e=>{t.trigger.move(e)})})},reset:()=>{e=S.none()},events:t.registry}})(),r=e;return{on:()=>{r.reset(),r=t},off:()=>{r.reset(),r=e},isOn:()=>r===t,onEvent:(e,t)=>{r.onEvent(e,t)},events:t.events}},ma=e=>{let t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},mi=ma("ephox-dragster").resolve;var mm=mo({compare:(e,t)=>rV(t.left-e.left,t.top-e.top),extract:e=>S.some(rV(e.x,e.y)),sink:(e,t)=>{let r=(e=>{let t={layerClass:mi("blocker"),...e},r=eC.fromTag("div");return eh(r,"role","presentation"),tx(r,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),iX(r,mi("blocker")),iX(r,t.layerClass),{element:h(r),destroy:()=>{eq(r)}}})(t),o=i2(r.element(),"mousedown",e.forceDrop),l=i2(r.element(),"mouseup",e.drop),n=i2(r.element(),"mousemove",e.move),s=i2(r.element(),"mouseout",e.delayDrop);return ml({element:r.element,start:e=>{eI(e,r.element())},stop:()=>{eq(r.element())},destroy:()=>{r.destroy(),l.unbind(),n.unbind(),s.unbind(),o.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});let md=ma("ephox-snooker").resolve,mc=md("resizer-bar"),mu=md("resizer-rows"),mf=md("resizer-cols"),mg=e=>{B(tt(e.parent(),"."+mc),eq)},mh=(e,t,r)=>{let o=e.origin();B(t,t=>{t.each(t=>{let l=r(o,t);iX(l,mc),eI(e.parent(),l)})})},mp=(e,t,r,o,l)=>{var n,s,a,i;let m=rU(r),d=t.isResizable,c=o.length>0?r5.positions(o,r):[],u=c.length>0?P(e.all,(e,t)=>d(e.element)?[t]:[]):[];n=z(c,(e,t)=>k(u,e=>t===e)),s=ru(r),mh(t,n,(e,t)=>{let r=((e,t,r,o,l)=>{let n=eC.fromTag("div");return tx(n,{position:"absolute",left:t+"px",top:r-3.5+"px",height:"7px",width:o+"px"}),ep(n,{"data-row":e,role:"presentation"}),n})(t.row,m.left-e.left,t.y-e.top,s);return iX(r,mu),r});let f=l.length>0?r7.positions(l,r):[],g=f.length>0?((e,t)=>{let r=[];return E(e.grid.columns,o=>{rL(e,o).map(e=>e.element).forall(t)&&r.push(o)}),z(r,r=>I(rO(e,e=>e.column===r),e=>t(e.element)))})(e,d):[];a=z(f,(e,t)=>k(g,e=>t===e)),i=r$(r),mh(t,a,(e,t)=>{let r=((e,t,r,o,l)=>{let n=eC.fromTag("div");return tx(n,{position:"absolute",left:t-3.5+"px",top:r+"px",height:l+"px",width:"7px"}),ep(n,{"data-column":e,role:"presentation"}),n})(t.col,t.x-e.left,m.top-e.top,0,i);return iX(r,mf),r})},mb=(e,t)=>{if(mg(e),e.isResizable(t)){let r=rE(t),o=rj(r),l=rW(r);mp(r,e,t,o,l)}},mw=(e,t)=>{B(tt(e.parent(),"."+mc),t)},mv=e=>{mw(e,e=>{ty(e,"display","none")})},my=e=>{mw(e,e=>{ty(e,"display","block")})},mx=md("resizer-bar-dragging"),mC=e=>{let t=(()=>{let e=i8({drag:i6(["xDelta","yDelta","target"])}),t=S.none(),r=(()=>{let e=i8({drag:i6(["xDelta","yDelta"])});return{mutate:(t,r)=>{e.trigger.drag(t,r)},events:e.registry}})();return r.events.drag.bind(r=>{t.each(t=>{e.trigger.drag(r.xDelta,r.yDelta,t)})}),{assign:e=>{t=S.some(e)},get:()=>t,mutate:r.mutate,events:e.registry}})(),r=((e,t={})=>{var r;return((e,t,r)=>{let o=!1,l=i8({start:i6([]),stop:i6([])}),n=ms(),s=()=>{d.stop(),n.isOn()&&(n.off(),l.trigger.stop())},a=((e,t)=>{let r=null,o=()=>{i(r)||(clearTimeout(r),r=null)};return{cancel:o,throttle:(...t)=>{o(),r=setTimeout(()=>{r=null,e.apply(null,t)},200)}}})(s);n.events.move.bind(r=>{t.mutate(e,r.info)});let m=e=>(...t)=>{o&&e.apply(null,t)},d=t.sink(mn({forceDrop:s,drop:m(s),move:m(e=>{a.cancel(),n.onEvent(e,t)}),delayDrop:m(a.throttle)}),r);return{element:d.element,go:e=>{d.start(e),n.on(),l.trigger.start()},on:()=>{o=!0},off:()=>{o=!1},isActive:()=>o,destroy:()=>{d.destroy()},events:l.registry}})(e,null!==(r=t.mode)&&void 0!==r?r:mm,t)})(t,{}),o=S.none(),l=(e,t)=>S.from(eb(e,t));t.events.drag.bind(e=>{l(e.target,"data-row").each(t=>{let r=tE(e.target,"top");ty(e.target,"top",r+e.yDelta+"px")}),l(e.target,"data-column").each(t=>{let r=tE(e.target,"left");ty(e.target,"left",r+e.xDelta+"px")})});let n=(e,t)=>tE(e,t)-tD(e,"data-initial-"+t,0);r.events.stop.bind(()=>{t.get().each(t=>{o.each(r=>{l(t,"data-row").each(e=>{let o=n(t,"top");ev(t,"data-initial-top"),c.trigger.adjustHeight(r,o,parseInt(e,10))}),l(t,"data-column").each(e=>{let o=n(t,"left");ev(t,"data-initial-left"),c.trigger.adjustWidth(r,o,parseInt(e,10))}),mb(e,r)})})});let s=(o,l)=>{c.trigger.startAdjust(),t.assign(o),eh(o,"data-initial-"+l,tE(o,l)),iX(o,mx),ty(o,"opacity","0.2"),r.go(e.parent())},a=i2(e.parent(),"mousedown",e=>{iZ(e.target,mu)&&s(e.target,"top"),iZ(e.target,mf)&&s(e.target,"left")}),m=t=>eD(t,e.view()),d=i2(e.view(),"mouseover",t=>{ti(t.target,"table",m).filter(lr).fold(()=>{e7(t.target)&&mg(e)},t=>{r.isActive()&&(o=S.some(t),mb(e,t))})}),c=i8({adjustHeight:i6(["table","delta","row"]),adjustWidth:i6(["table","delta","column"]),startAdjust:i6([])});return{destroy:()=>{a.unbind(),d.unbind(),r.destroy(),mg(e)},refresh:t=>{mb(e,t)},on:r.on,off:r.off,hideBars:w(mv,e),showBars:w(my,e),events:c.registry}},mS=e=>c(e)&&"TABLE"===e.nodeName,mT="bar-",mR=e=>"false"!==eb(e,"data-mce-resize"),mD=e=>{let t,r,o,l;let n=ix(),s=ix(),a=ix(),i=t=>sY(e,t),m=()=>o0(e)?l7():l2(),d=(n,s,a,d)=>{var c,u;let f=tg(s,"corner-")?s.substring(7):s,g=th(f,"e"),h=tg(f,"n");if(""===r&&ar(n),""===l&&(e=>{let t=rH(e)+"px";s4(e,S.none(),S.some(t)),at(e)})(n),a!==t&&""!==r){ty(n,"width",r);let o=m(),l=i(n),s=o0(e)||g?l4(n).columns-1:0;nY(n,a-t,s,o,l)}else c=r,/^(\d+(\.\d+)?)%$/.test(c)&&ty(n,"width",a*parseFloat(r.replace("%",""))/t+"%");if(u=r,/^(\d+(\.\d+)?)px$/.test(u)&&(rA(rE(n))||B(tL(n),e=>{let t=tC(e,"width");ty(e,"width",t),ev(e,"width")})),d!==o&&""!==l){ty(n,"height",l);let e=h?0:l4(n).rows-1;nJ(n,d-o,e)}};return e.on("init",()=>{var t,r;let o=e.inline?(t=eC.fromDom(e.getBody()),{parent:h((()=>{let e=eC.fromTag("div");return tx(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),eI(e4(eC.fromDom(document)),e),e})()),view:h(t),origin:h(rV(0,0)),isResizable:mR}):{parent:h(ec(r=eC.fromDom(e.getDoc()))?eC.fromDom(eE(r).dom.documentElement):r),view:h(r),origin:h(rV(0,0)),isResizable:mR};if(a.set(o),O(e.options.get("object_resizing").split(","),"table")&&o7(e)){let t=((e,t,r)=>{let o=mC(e),l=i8({beforeResize:i6(["table","type"]),afterResize:i6(["table","type"]),startDrag:i6([])});return o.events.adjustHeight.bind(e=>{let t=e.table;l.trigger.beforeResize(t,"row");let r=r5.delta(e.delta,t);nJ(t,r,e.row),l.trigger.afterResize(t,"row")}),o.events.startAdjust.bind(e=>{l.trigger.startDrag()}),o.events.adjustWidth.bind(e=>{let o=e.table;l.trigger.beforeResize(o,"col");let n=r7.delta(e.delta,o),s=r(o);nY(o,n,e.column,t,s),l.trigger.afterResize(o,"col")}),{on:o.on,off:o.off,refreshBars:o.refresh,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:l.registry}})(o,m(),i);t.on(),t.events.startDrag.bind(t=>{n.set(e.selection.getRng())}),t.events.beforeResize.bind(t=>{let r=t.table.dom;((e,t,r,o,l)=>{e.dispatch("ObjectResizeStart",{target:t,width:r,height:o,origin:l})})(e,r,li(r),lm(r),mT+t.type)}),t.events.afterResize.bind(t=>{let r=t.table,o=r.dom;ls(r),n.on(t=>{e.selection.setRng(t),e.focus()}),((e,t,r,o,l)=>{e.dispatch("ObjectResized",{target:t,width:r,height:o,origin:l})})(e,o,li(o),lm(o),mT+t.type),e.undoManager.add()}),s.set(t)}}),e.on("ObjectResizeStart",n=>{let s=n.target;if(mS(s)){let a=eC.fromDom(s);B(e.dom.select(".mce-clonedresizable"),t=>{e.dom.addClass(t,"mce-"+oZ(e)+"-columns")}),!s8(a)&&o5(e)?ao(a):!s6(a)&&o3(e)&&ar(a),ae(a)&&tg(n.origin,mT)&&ar(a),t=n.width,r=o2(e)?"":lc(e,s).getOr(""),o=n.height,l=lu(e,s).getOr("")}}),e.on("ObjectResized",t=>{let r=t.target;if(mS(r)){let o=eC.fromDom(r),l=t.origin;tg(l,"corner-")&&d(o,l,t.width,t.height),ls(o),sq(e,o.dom,sU)}}),e.on("SwitchMode",()=>{s.on(t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()})}),e.on("dragstart dragend",e=>{s.on(t=>{"dragstart"===e.type?(t.hideBars(),t.off()):(t.on(),t.showBars())})}),e.on("remove",()=>{s.on(e=>{e.destroy()}),a.on(t=>{e.inline&&eq(t.parent())})}),{refresh:e=>{s.on(t=>t.refreshBars(eC.fromDom(e)))},hide:()=>{s.on(e=>e.hideBars())},show:()=>{s.on(e=>e.showBars())}}},mO=e=>{(e=>{let t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{let t=O(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{let t=O(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0}),t("table_merge_content_on_paste",{processor:"boolean",default:!0})})(e);let t=mD(e),r=i4(e,t),o=sJ(e,t,r);return aS(e,o),((e,t)=>{let r=ln(e),o=t=>lq(la(e)).bind(o=>tM(o,r).map(r=>{let l=lH(lU(e),r,o);return t(r,l)})).getOr("");K({mceTableRowType:()=>o(t.getTableRowType),mceTableCellType:()=>o(t.getTableCellType),mceTableColType:()=>o(t.getTableColType)},(t,r)=>e.addQueryValueHandler(r,t))})(e,o),lG(e,o),{getSelectedCells:r.getSelectedCells,clearSelectedCells:r.clearSelectedCells}};t.add("dom",e=>({table:mO(e)}))}();