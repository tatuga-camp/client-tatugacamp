!function(){"use strict";let e=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}};var t=tinymce.util.Tools.resolve("tinymce.PluginManager");let n=(e,t,n)=>{var r;return!!n(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},r=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&n(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},o=e=>t=>r(t)===e,u=e=>t=>typeof t===e,l=o("string"),a=o("array"),s=u("boolean"),i=e=>null==e,d=e=>!i(e),c=u("number"),m=()=>{},h=e=>()=>e,g=h(!0),f=h(`[~\u2116|!-*+-\\/:;?@\\[-\`{}\u00A1\u00AB\u00B7\u00BB\u00BF;\u00B7\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1361-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u3008\u3009\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30\u2E31\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]`);class p{constructor(e,t){this.tag=e,this.value=t}static some(e){return new p(!0,e)}static none(){return p.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?p.some(e(this.value)):p.none()}bind(e){return this.tag?e(this.value):p.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:p.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?p.some(e):p.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}p.singletonNone=new p(!1);var F=tinymce.util.Tools.resolve("tinymce.Env"),A=tinymce.util.Tools.resolve("tinymce.util.Tools");let E=Array.prototype.slice,y=Array.prototype.push,x=(e,t)=>{let n=e.length,r=Array(n);for(let o=0;o<n;o++){let n=e[o];r[o]=t(n,o)}return r},b=(e,t)=>{for(let n=0,r=e.length;n<r;n++)t(e[n],n)},C=(e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)},D=(e,t)=>{if(0===e.length)return[];{let n=t(e[0]),r=[],o=[];for(let u=0,l=e.length;u<l;u++){let l=e[u],a=t(l);a!==n&&(r.push(o),o=[]),n=a,o.push(l)}return 0!==o.length&&r.push(o),r}},v=(e,t,n)=>(b(e,(e,r)=>{n=t(n,e,r)}),n),w=e=>{let t=[];for(let n=0,r=e.length;n<r;++n){if(!a(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);y.apply(t,e[n])}return t},B=(e,t)=>w(x(e,t)),N=(e,t)=>{let n=E.call(e,0);return n.sort(t),n},T=Object.hasOwnProperty,O=(e,t)=>T.call(e,t);"undefined"!=typeof window?window:Function("return this;")();let k=e=>e.dom.nodeType,S=(e,t,n)=>{if(l(n)||s(n)||c(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),Error("Attribute value was not simple")},M=(e,t,n)=>{S(e.dom,t,n)},I=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},R={fromHtml:(e,t)=>{let n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return I(n.childNodes[0])},fromTag:(e,t)=>I((t||document).createElement(e)),fromText:(e,t)=>I((t||document).createTextNode(e)),fromDom:I,fromPoint:(e,t,n)=>p.from(e.dom.elementFromPoint(t,n)).map(I)},P=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,W=(e,t)=>{let n=void 0===t?document:t.dom;return P(n)?[]:x(n.querySelectorAll(e),R.fromDom)},$=e=>p.from(e.dom.parentNode).map(R.fromDom),V=e=>x(e.dom.childNodes,R.fromDom),j=(e,t)=>({element:e,offset:t}),H=(e,t)=>{let n=V(e);return n.length>0&&t<n.length?j(n[t],0):j(e,t)},z=(e,t)=>{$(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},L=(e,t)=>{e.dom.appendChild(t.dom)},U=(e,t)=>{z(e,t),L(t,e)},_=((e,t)=>{let n=t=>e(t)?p.from(t.dom.nodeValue):p.none();return{get:r=>{if(!e(r))throw Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:(n,r)=>{if(!e(n))throw Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}})(e=>3===k(e),"text"),q=e=>_.get(e),G=(e,t,n)=>(e.compareDocumentPosition(t)&n)!=0,K=(e,t)=>G(e,t,Node.DOCUMENT_POSITION_PRECEDING),J=(e,t)=>W(t,e);var Q=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker");let X=(e,t)=>e.isBlock(t)||O(e.schema.getVoidElements(),t.nodeName),Y=(e,t)=>!e.isEditable(t),Z=(e,t)=>"true"===e.getContentEditable(t)&&t.parentNode&&!e.isEditable(t.parentNode),ee=(e,t)=>!e.isBlock(t)&&O(e.schema.getWhitespaceElements(),t.nodeName),et=(e,t)=>X(e,t)||Y(e,t)||ee(e,t)||Z(e,t),en=e=>3===e.nodeType,er=()=>({sOffset:0,fOffset:0,elements:[]}),eo=(e,t)=>H(R.fromDom(e),t),eu=(e,t,n,r,o,u=!0)=>{let l=u?t(!1):n;for(;l;){let n=Y(e,l);if(n||ee(e,l)){if(n?r.cef(l):r.boundary(l))break;l=t(!0);continue}if(X(e,l)){if(r.boundary(l))break}else en(l)&&r.text(l);if(l===o)break;l=t(!1)}},el=(e,t,n,r,o)=>{var u;if(et(e,n))return;let l=new Q(n,null!==(u=e.getParent(r,e.isBlock))&&void 0!==u?u:e.getRoot());eu(e,o?l.next.bind(l):l.prev.bind(l),n,{boundary:g,cef:g,text:e=>{o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(R.fromDom(e))}})},ea=(e,t,n,r,o,u=!0)=>{let l=new Q(n,t),a=[],s=er();el(e,s,n,t,!1);let i=()=>(s.elements.length>0&&(a.push(s),s=er()),!1);return eu(e,l.next.bind(l),n,{boundary:i,cef:e=>(i(),o&&a.push(...o.cef(e)),!1),text:e=>{s.elements.push(R.fromDom(e)),o&&o.text(e,s)}},r,u),r&&el(e,s,r,t,!0),i(),a},es=(e,t)=>{let n=eo(t.startContainer,t.startOffset),r=n.element.dom,o=eo(t.endContainer,t.endOffset),u=o.element.dom;return ea(e,t.commonAncestorContainer,r,u,{text:(e,t)=>{e===u?t.fOffset+=e.length-o.offset:e===r&&(t.sOffset+=n.offset)},cef:t=>N(B(J(R.fromDom(t),"*[contenteditable=true]"),t=>{let n=t.dom;return ea(e,n,n)}),(e,t)=>K(e.elements[0].dom,t.elements[0].dom)?1:-1)},!1)},ei=(e,t)=>t.collapsed?[]:es(e,t),ed=(e,t)=>{let n=e.createRng();return n.selectNode(t),ei(e,n)},ec=(e,t)=>B(t,t=>ed(e,t)),em=(e,t,n=0,r=e.length)=>{let o;let u=t.regex;u.lastIndex=n;let l=[];for(;o=u.exec(e);){let e=o[t.matchIndex],n=o.index+o[0].indexOf(e),a=n+e.length;if(a>r)break;l.push({start:n,finish:a}),u.lastIndex=a}return l},eh=(e,t)=>D(v(e,(e,n)=>{let r=q(n),o=e.last,u=o+r.length,l=B(t,(e,t)=>e.start<u&&e.finish>o?[{element:n,start:Math.max(o,e.start)-o,finish:Math.min(u,e.finish)-o,matchId:t}]:[]);return{results:e.results.concat(l),last:u}},{results:[],last:0}).results,e=>e.matchId),eg=(e,t)=>B(t,t=>{let n=t.elements,r=x(n,q).join("");return eh(n,em(r,e,t.sOffset,r.length-t.fOffset))}),ef=(e,t)=>{C(e,(e,n)=>{C(e,e=>{let r=R.fromDom(t.cloneNode(!1));M(r,"data-mce-index",n);let o=e.element.dom;if(o.length===e.finish&&0===e.start)U(e.element,r);else{o.length!==e.finish&&o.splitText(e.finish);let t=o.splitText(e.start);U(R.fromDom(t),r)}})})},ep=(e,t,n,r)=>{let o=eg(t,ed(e,n));return ef(o,r),o.length},eF=(e,t,n,r)=>{let o=n.getBookmark(),u=e.select("td[data-mce-selected],th[data-mce-selected]"),l=eg(t,u.length>0?ec(e,u):ei(e,n.getRng()));return ef(l,r),n.moveToBookmark(o),l.length},eA=e=>e.getAttribute("data-mce-index"),eE=(e,t,n,r)=>{let o=e.dom.create("span",{"data-mce-bogus":1});o.className="mce-match-marker";let u=e.getBody();return(eO(e,t,!1),r)?eF(e.dom,n,e.selection,o):ep(e.dom,n,u,o)},ey=e=>{var t;let n=e.parentNode;e.firstChild&&n.insertBefore(e.firstChild,e),null===(t=e.parentNode)||void 0===t||t.removeChild(e)},ex=(e,t)=>{let n=[],r=A.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(let e=0;e<r.length;e++){let o=eA(r[e]);null!==o&&o.length&&o===t.toString()&&n.push(r[e])}return n},eb=(e,t,n)=>{let r=t.get(),o=r.index,u=e.dom;n?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,u.removeClass(ex(e,r.index),"mce-match-marker-selected");let l=ex(e,o);return l.length?(u.addClass(ex(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(l[0]),o):-1},eC=(e,t)=>{let n=t.parentNode;e.remove(t),n&&e.isEmpty(n)&&e.remove(n)},eD=(e,t)=>{let n="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")";return t?`(?:^|\\s|${f()})`+n+`(?=$|\\s|${f()})`:n},ev=(e,t,n,r,o,u)=>{let l=e.selection,a=eD(n,o),s=l.isForward(),i=eE(e,t,{regex:new RegExp(a,r?"g":"gi"),matchIndex:1},u);if(F.browser.isSafari()&&l.setRng(l.getRng(),s),i){let l=eb(e,t,!0);t.set({index:l,count:i,text:n,matchCase:r,wholeWord:o,inSelection:u})}return i},ew=(e,t)=>{let n=eb(e,t,!0);t.set({...t.get(),index:n})},eB=(e,t)=>{let n=eb(e,t,!1);t.set({...t.get(),index:n})},eN=e=>{let t=eA(e);return null!==t&&t.length>0},eT=(e,t,n,r,o)=>{let u=t.get(),l=u.index,a,s=l;r=!1!==r;let i=e.getBody(),d=A.grep(A.toArray(i.getElementsByTagName("span")),eN);for(let t=0;t<d.length;t++){let i=a=parseInt(eA(d[t]),10);if(o||i===u.index){for(n.length?(d[t].innerText=n,ey(d[t])):eC(e.dom,d[t]);d[++t];)if((i=parseInt(eA(d[t]),10))===a)eC(e.dom,d[t]);else{t--;break}r&&s--}else a>l&&d[t].setAttribute("data-mce-index",String(a-1))}return t.set({...u,count:o?0:u.count-1,index:s}),r?ew(e,t):eB(e,t),!o&&t.get().count>0},eO=(e,t,n)=>{let r,o;let u=t.get(),l=A.toArray(e.getBody().getElementsByTagName("span"));for(let e=0;e<l.length;e++){let t=eA(l[e]);null!==t&&t.length&&(t===u.index.toString()&&(r||(r=l[e].firstChild),o=l[e].firstChild),ey(l[e]))}if(t.set({...u,index:-1,count:0,text:""}),r&&o){let t=e.dom.createRng();return t.setStart(r,0),t.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(t),t}},ek=(e,t)=>t.get().count>1,eS=(e,t)=>t.get().count>1,eM=(e,t)=>({done:n=>eO(e,t,n),find:(n,r,o,u=!1)=>ev(e,t,n,r,o,u),next:()=>ew(e,t),prev:()=>eB(e,t),replace:(n,r,o)=>eT(e,t,n,r,o)}),eI=t=>{let n=e(p.none()),r=()=>n.get().each(t);return{clear:()=>{r(),n.set(p.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:e=>{r(),n.set(p.some(e))}}},eR=()=>{let e=eI(m);return{...e,on:t=>e.get().each(t)}},eP=(e,t)=>{let n=eR();e.undoManager.add();let r=A.trim(e.selection.getContent({format:"text"})),o=n=>{n.setEnabled("next",ek(e,t)),n.setEnabled("prev",eS(e,t))},u=e=>{let n=e.getData(),r=t.get();t.set({...r,matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection})},l=(e,t)=>{b(["replace","replaceall","prev","next"],n=>e.setEnabled(n,!t))},a=(e,t)=>{t.redial(g(e,t.getData()))},s=(e,t)=>{F.browser.isSafari()&&F.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},i=n=>{eO(e,t,!1),l(n,!0),o(n)},d=n=>{let r=n.getData(),u=t.get();if(!r.findtext.length){i(n);return}if(u.text===r.findtext&&u.matchCase===r.matchcase&&u.wholeWord===r.wholewords)ew(e,t);else{let o=ev(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);o<=0&&a(!0,n),l(n,0===o)}o(n)},c=t.get(),m={findtext:r,replacetext:"",wholewords:c.wholeWord,matchcase:c.matchCase,inselection:c.inSelection},h=e=>{let t=[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",enabled:!1,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",enabled:!1,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}];return e&&t.push({type:"alertbanner",level:"error",text:"Could not find the specified string.",icon:"warning"}),t},g=(n,r)=>({title:"Find and Replace",size:"normal",body:{type:"panel",items:h(n)},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",enabled:!1},{type:"custom",name:"replaceall",text:"Replace all",enabled:!1}],initialData:r,onChange:(e,r)=>{n&&a(!1,e),"findtext"===r.name&&t.get().count>0&&i(e)},onAction:(n,r)=>{let l=n.getData();switch(r.name){case"find":d(n);break;case"replace":eT(e,t,l.replacetext)?o(n):i(n);break;case"replaceall":eT(e,t,l.replacetext,!0,!0),i(n);break;case"prev":eB(e,t),o(n);break;case"next":ew(e,t),o(n);break;case"matchcase":case"wholewords":case"inselection":a(!1,n),u(n),i(n)}s(n,r.name)},onSubmit:e=>{d(e),s(e,"find")},onClose:()=>{e.focus(),eO(e,t),e.undoManager.add()}});n.set(e.windowManager.open(g(!1,m),{inline:"toolbar"}))},eW=(e,t)=>{e.addCommand("SearchReplace",()=>{eP(e,t)})},e$=(e,t)=>()=>{eP(e,t)},eV=(e,t)=>{e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:e$(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:e$(e,t),icon:"search",shortcut:"Meta+F"}),e.shortcuts.add("Meta+F","",e$(e,t))};t.add("searchreplace",t=>{let n=e({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return eW(t,n),eV(t,n),eM(t,n)})}();