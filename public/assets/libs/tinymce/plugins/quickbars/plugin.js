!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=(e,t,o)=>{var r;return!!o(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},o=e=>{let o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&t(e,String,(e,t)=>t.isPrototypeOf(e))?"string":o},r=e=>t=>typeof t===e,i=e=>"string"===o(e),n=r("boolean"),a=e=>null==e,l=e=>!a(e),s=r("function"),u=e=>t=>t.options.get(e),c=e=>{let t=e.options.register,o=e=>t=>{let o=n(t)||i(t);return o?n(t)?{value:t?e:"",valid:o}:{value:t.trim(),valid:o}:{valid:!1,message:"Must be a boolean or string."}},r="bold italic | quicklink h2 h3 blockquote";t("quickbars_selection_toolbar",{processor:o(r),default:r});let a="quickimage quicktable";t("quickbars_insert_toolbar",{processor:o(a),default:a});let l="alignleft aligncenter alignright";t("quickbars_image_toolbar",{processor:o(l),default:l})},d=u("quickbars_selection_toolbar"),m=u("quickbars_insert_toolbar"),h=u("quickbars_image_toolbar"),g=0,f=e=>{let t=new Date().getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++g+String(t)},b=(e,t,o)=>{e.execCommand("mceInsertTable",!1,{rows:o,columns:t})},p=(e,t,o)=>{let r=e.editorUpload.blobCache,i=r.create(f("mceu"),o,t);r.add(i),e.insertContent(e.dom.createHTML("img",{src:i.blobUri()}))},v=e=>new Promise(t=>{let o=new FileReader;o.onloadend=()=>{t(o.result.split(",")[1])},o.readAsDataURL(e)});var y=tinymce.util.Tools.resolve("tinymce.util.Delay");let k=e=>new Promise(t=>{let o=!1,r=document.createElement("input");r.type="file",r.accept="image/*",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.opacity="0.001",document.body.appendChild(r);let i=e=>{var i;o||(null===(i=r.parentNode)||void 0===i||i.removeChild(r),o=!0,t(e))},n=e=>{i(Array.prototype.slice.call(e.target.files))};r.addEventListener("input",n),r.addEventListener("change",n);let a=t=>{let r=()=>{i([])};o||("focusin"===t.type?y.setEditorTimeout(e,r,1e3):r()),e.off("focusin remove",a)};e.on("focusin remove",a),r.click()}),w=e=>{e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{k(e).then(t=>{if(t.length>0){let o=t[0];v(o).then(t=>{p(e,t,o)})}})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{b(e,2,2)}})},T=()=>!1;class N{constructor(e,t){this.tag=e,this.value=t}static some(e){return new N(!0,e)}static none(){return N.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?N.some(e(this.value)):N.none()}bind(e){return this.tag?e(this.value):N.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:N.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return l(e)?N.some(e):N.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}N.singletonNone=new N(!1),"undefined"!=typeof window?window:Function("return this;")();let E=e=>e.dom.nodeName.toLowerCase(),q=(e,t)=>{let o=e.dom;return!!o&&!!o.hasAttribute&&o.hasAttribute(t)};var M=(e,t,o,r,i)=>e(o,r)?N.some(o):s(i)&&i(o)?N.none():t(o,r,i);let _=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},C={fromHtml:(e,t)=>{let o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return _(o.childNodes[0])},fromTag:(e,t)=>_((t||document).createElement(e)),fromText:(e,t)=>_((t||document).createTextNode(e)),fromDom:_,fromPoint:(e,t,o)=>N.from(e.dom.elementFromPoint(t,o)).map(_)},S=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},x=(e,t,o)=>{let r=e.dom,i=s(o)?o:T;for(;r.parentNode;){r=r.parentNode;let e=C.fromDom(r);if(t(e))return N.some(e);if(i(e))break}return N.none()},A=(e,t,o)=>M((e,t)=>t(e),x,e,t,o),L=(e,t,o)=>A(e,t,o).isSome(),D=(e,t,o)=>x(e,e=>S(e,t),o),O=(e,t,o)=>M((e,t)=>S(e,t),D,e,t,o),P=e=>{let t=m(e);t.length>0&&e.ui.registry.addContextToolbar("quickblock",{predicate:t=>{let o=C.fromDom(t),r=e.schema.getTextBlockElements(),i=t=>t.dom===e.getBody();return!q(o,"data-mce-bogus")&&O(o,'table,[data-mce-bogus="all"]',i).fold(()=>L(o,t=>E(t) in r&&e.dom.isEmpty(t.dom),i),T)},items:t,position:"line",scope:"editor"})},B=e=>void 0!==e.dom.classList,I=(e,t)=>B(e)&&e.dom.classList.contains(t),U=e=>{let t=t=>e.dom.isEditable(t),o=e=>t(e.parentElement),r=e=>{let t="FIGURE"===e.nodeName&&/image/i.test(e.className),r="IMG"===e.nodeName||t,i=I(C.fromDom(e),"mce-pagebreak");return r&&o(e)&&!i},i=h(e);i.length>0&&e.ui.registry.addContextToolbar("imageselection",{predicate:r,items:i,position:"node"});let n=d(e);n.length>0&&e.ui.registry.addContextToolbar("textselection",{predicate:o=>!r(o)&&!e.selection.isCollapsed()&&t(o),items:n,position:"selection",scope:"editor"})};e.add("quickbars",e=>{c(e),w(e),P(e),U(e)})}();